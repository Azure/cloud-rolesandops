{
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "Planning Guide for Cloud Roles and Operations Management v0.9a",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "azure monitor",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "variables": {
    "workbookContent": {
      "version": "Notebook/1.0",
      "items": [
        {
          "type": 9,
          "content": {
            "version": "KqlParameterItem/1.0",
            "parameters": [
              {
                "id": "21f4ffd3-69ce-4ced-acee-b5386ad38a6b",
                "version": "KqlParameterItem/1.0",
                "name": "ShowHelp",
                "label": "Show Information",
                "type": 10,
                "isRequired": true,
                "isGlobal": true,
                "typeSettings": {
                  "additionalResourceOptions": [],
                  "showDefault": false
                },
                "jsonData": "[[{ \"value\": \"Yes\", \"label\": \"Yes\"},\r\n {\"value\": \"No\", \"label\": \"No\", \"selected\":true }]",
                "timeContext": {
                  "durationMs": 86400000
                }
              },
              {
                "id": "55ab2be5-f2df-4430-9cfb-58f796ff383d",
                "version": "KqlParameterItem/1.0",
                "name": "Subscription",
                "type": 6,
                "isRequired": true,
                "multiSelect": true,
                "quote": "'",
                "delimiter": ",",
                "value": [
                  "value::all"
                ],
                "typeSettings": {
                  "limitSelectTo": 100,
                  "additionalResourceOptions": [
                    "value::all"
                  ],
                  "includeAll": false
                },
                "timeContext": {
                  "durationMs": 86400000
                }
              },
              {
                "id": "0910a182-5ea7-4152-8f61-a46833f7bc08",
                "version": "KqlParameterItem/1.0",
                "name": "Workspace",
                "type": 5,
                "description": "Select the Log Analytics Workspace with the Cloud Task table.",
                "isRequired": true,
                "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| project id",
                "crossComponentResources": [
                  "value::all"
                ],
                "value": "",
                "typeSettings": {
                  "resourceTypeFilter": {
                    "microsoft.operationalinsights/workspaces": true
                  },
                  "additionalResourceOptions": [],
                  "showDefault": false
                },
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources"
              }
            ],
            "style": "pills",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          "name": "parameters - 5"
        },
        {
          "type": 1,
          "content": {
            "json": "ðŸ’¡_The **Subscription** parameter determines the scope of information displayed in the environment and management score tabs._\r\n\r\n_The **Workspace** parameter is used to set the log analytics workspace that is used to store the CloudOps table._"
          },
          "conditionalVisibility": {
            "parameterName": "ShowHelp",
            "comparison": "isEqualTo",
            "value": "Yes"
          },
          "name": "text - 7 - Copy"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "<br>\r\n[![Azure](https://azure.microsoft.com/svghandler/preview/)](https://azure.microsoft.com/svghandler/preview/)"
                },
                "customWidth": "5",
                "name": "text - 1"
              },
              {
                "type": 1,
                "content": {
                  "json": "## [Customer Name] \r\n### Planning Guide for Cloud Roles and Operations Management\r\nversion 0.9a\r\n\r\nThis workbook is designed to be a living document. The content represent a starting point for developing a cloud roles and operations management framework.\r\n\r\nManagement tasks can be automated (IaC, policy, alert rules, etc) or manual. Both of these modes are represented in this workbook. It should be noted that even automated tasks need initial definition and routine review."
                },
                "customWidth": "95",
                "name": "text - 3"
              },
              {
                "type": 1,
                "content": {
                  "json": "author: FastTrack for Azure \r\n<br><br>\r\n\r\nThe Task tab allows pivoting to the below catgories:\r\n\r\n- **Foundation Tasks** : Generic tasks that apply broadly to all resources and services. \r\n- **Service Tasks** : Azure Services tasks to manage resources e.g. Azure Monitor, Defender for Cloud, etc.\r\n- **Platform Tasks** : Tasks typically associated with [platform landing zone](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/#platform-vs-application-landing-zones) resources e.g. Azure Firewall, VNET, etc. \r\n- **Application Tasks** : Tasks typically associated with [application landing zone](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/#platform-vs-application-landing-zones) resources e.g. App Services, Application Gateways, etc.\r\n- **Solution Tasks** : Tasks used to manage a complete solution e.g. Azure Virtual Desktop, SAP on Azure, Azure VMware services or a line-of-business system.\r\n\r\nTo Remove the [Customer Name] and change it to your Organization Name, edit this workbook and use CTRL-F to Find and Replace the [Customer Name] with your desired Organization Name.",
                  "style": "info"
                },
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "helptxt"
              },
              {
                "type": 1,
                "content": {
                  "json": "### Change Log \r\n\r\n|Version|Description|Owner|\r\n|---|---|---|\r\n|v0.4| Task tables in markdown|Johan|\r\n|v0.5| Added management score based on number of tasks completed. Task completion is based on status, date completed and task frequency fields. A completed status is achieved when the date completed falls within the frequency period. Ad hoc tasks are to be excluded.|Johan|\r\n|v0.6| Added a simplified task update feature via law, logic app, aad, storage blob and csv for tasks.|Johan|  \r\n|v0.7.1|Added a task tab that allows filtering by team, frequency, mode, etc. Tasks per managing service view e.g. Azure Monitor (15 completed, 6 open, 3 retired, etc)|Jason and Johan|\r\n|v0.7.3|Added a systemAssignedDateNext field. |Johan|\r\n|v0.7.5|Management score and environment updates. |Johan|\r\n|v0.7.7|Simplified to excel on the web, log analytics workspace and logic app.|Johan|\r\n|v0.7.8|Pilot version.|Johan|",
                  "style": "info"
                },
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "changelogtxt"
              },
              {
                "type": 1,
                "content": {
                  "json": "### Backlog \r\n\r\n|Version|Description|Owner|\r\n|---|---|\r\n|v0.7.9|Automate RACI.|Johan|\r\n|v0.8|Add tech visuals.|Johan|",
                  "style": "upsell"
                },
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "text - 3"
              }
            ]
          },
          "name": "customerlogogrp"
        },
        {
          "type": 11,
          "content": {
            "version": "LinkItem/1.0",
            "style": "paragraph",
            "links": [
              {
                "id": "423f9dc0-b93c-4b30-afee-9bc980e028a7",
                "cellValue": "selectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Service Management",
                "subTarget": "Service Management",
                "style": "secondary"
              },
              {
                "id": "6fa134cc-e845-451e-a731-0dcb464a7dfa",
                "cellValue": "selectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Management Score",
                "subTarget": "Management Score",
                "style": "secondary"
              },
              {
                "id": "bbb81f41-6121-4dab-9991-7c390be0aef8",
                "cellValue": "selectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Environment",
                "subTarget": "Environment",
                "style": "secondary"
              },
              {
                "id": "167016ad-bab2-42de-ba60-a992b30456f3",
                "cellValue": "selectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Initiative Definitions",
                "subTarget": "Initiative Definitions",
                "style": "secondary"
              },
              {
                "id": "c5b83691-f70d-4985-ae62-451a3f6acf7e",
                "cellValue": "selectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Task Definitions",
                "subTarget": "Task Definitions",
                "style": "secondary"
              }
            ]
          },
          "name": "links - 3"
        },
        {
          "type": 1,
          "content": {
            "json": "# {selectedTab}",
            "style": "info"
          },
          "conditionalVisibility": {
            "parameterName": "selectedTab",
            "comparison": "isNotEqualTo"
          },
          "name": "tab"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "items": [
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "parameters": [
                    {
                      "id": "5862a24c-8aed-49c0-b4e9-6bca33ba93e9",
                      "version": "KqlParameterItem/1.0",
                      "name": "selectedTab",
                      "label": "Select a topic",
                      "type": 10,
                      "isRequired": true,
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "jsonData": "[[\r\n {\"value\": \"Operating Model\", \"label\": \"Operating Model\", \"selected\":true },\r\n {\"value\": \"RACI\", \"label\": \"RACI\"},\r\n { \"value\": \"Documentation\", \"label\": \"Documentation\"},\r\n {\"value\": \"What is a Well-Managed Cloud?\", \"label\": \"What is a Well-Managed Cloud?\"}\r\n]",
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "value": "What is a Well-Managed Cloud?"
                    }
                  ],
                  "style": "formVertical",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                "name": "links2"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 1,
                      "content": {
                        "json": "[Customer Name] implemented the below [operating model](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/operating-model/compare) to support its cloud operations.\r\n\r\n| Capability/Team  |Description  | \r\n| ------------ | ------------ |\r\n|[Cloud Adoption (CA)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/organize/cloud-adoption)\t|Deliver technical solutions. The modern-day equivalent of technical implementation teams or project teams. The nature of the cloud might require more fluid team structures.\r\n|[Cloud Strategy (CS)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/organize/cloud-strategy)\t|Align technical change to business needs. Responsible for leading the cloud adoption within the organization, supporting all business outcomes, people and processes changes and technical projects.\r\n|[Cloud Operations (CO)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/organize/cloud-operations)\t|Support and operate adopted solutions. Focus on delivering maximum workload performance and minimum business interruptions within an agreed-upon operations budget.\r\n|[Cloud Center of Excellence (CCoE)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/organize/cloud-center-of-excellence)\t|Improve quality, speed, and resiliency of adoption\r\n|[Cloud Governance (CG)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/organize/cloud-governance)\t|Manage risk, drive consistency, governance, and compliance. Ensures that cloud-adoption risks and risk tolerance are properly evaluated and managed. The team identifies risks that can't be tolerated by the business, and it converts risks into governing corporate policies.\r\n|[Cloud Platform (CP)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/organize/cloud-platform)\t|Operate and mature the platform. Creation and support of the cloud platform or landing zones.\r\n|[Cloud Automation (CAU)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/organize/cloud-automation)\t|Accelerate adoption and innovation. The primary duty of cloud automation is to own and advance the solution catalog. The solution catalog is a collection of prebuilt solutions or automation templates."
                      },
                      "name": "operating"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Cloud Strategy Team\r\n\r\n| Name  |Role  | Email  |Mobile\r\n| ------------ | ------------ | ------------ | ------------ | \r\n| Michal Rosenstein  | Enterprise Architect |  michalrosenstein@contoso.com |  |\r\n| Ebere Ibeabuchi\t | Cloud Solution Architect | ebereibeabuchi@contoso.com |\t| ",
                        "style": "upsell"
                      },
                      "name": "cs"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Cloud Governance Team\r\n\r\n| Name  |Role  | Email  |Mobile\r\n| ------------ | ------------ | ------------ | ------------ | \r\n| Rita Tsakiris  | Security Category Owner  |  ritatsakiris@contoso.com |   |",
                        "style": "upsell"
                      },
                      "name": "cg"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Cloud Platform Team\r\n\r\n| Name  |Role  | Email  |Mobile\r\n| ------------ | ------------ | ------------ | ------------ | \r\n| Alexandra Voronova  | Lead Systems Engineer  |  alexandravoronova@contoso.com |  |",
                        "style": "upsell"
                      },
                      "name": "cp"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Cloud Adoption Team\r\n\r\n| Name  |Role  | Email  |Mobile\r\n| ------------ | ------------ | ------------ | ------------ | \r\n| Vasily Butusov  | Lead Systems Engineer  |  vasilybutusov@contoso.com |   |",
                        "style": "upsell"
                      },
                      "name": "ca"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Cloud Operations Team\r\n\r\n| Name  |Role  | Email  |Mobile\r\n| ------------ | ------------ | ------------ | ------------ | \r\n| Piet Smit  | Lead Systems Engineer  |  pietsmit@contoso.com |  |",
                        "style": "upsell"
                      },
                      "name": "co"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Operating Model"
                },
                "name": "com"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "list",
                        "links": [
                          {
                            "id": "395bc64a-0d41-49a0-a095-3dfa085da300",
                            "cellValue": "https://raw.githubusercontent.com/microsoft/CloudAdoptionFramework/master/plan/cloud-adoption-framework-strategy-and-plan-template.docx",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Cloud Strategic Plan",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "3937a3d6-9739-44af-9e84-2aed3066a119",
                            "cellValue": "https://raw.githubusercontent.com/microsoft/CloudAdoptionFramework/master/govern/governance-discipline-template.docx",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Governance Plan",
                            "preText": "07-06-2022",
                            "postText": "(Policy Statements and Design Guidance)",
                            "style": "link"
                          },
                          {
                            "id": "c00b3280-5aee-404a-812d-f55ef46a161c",
                            "cellValue": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/decision-guides/",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Architecture Decision Record",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "8d883929-fe57-4aa4-8935-eb5c317450a6",
                            "cellValue": "https://raw.githubusercontent.com/microsoft/CloudAdoptionFramework/master/ready/naming-and-tagging-conventions-tracking-template.xlsx",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Naming and Tagging Conventions",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "fc8e5fce-599b-4135-8b4d-c5fcaf9efbf9",
                            "cellValue": "https://github.com/microsoft/CloudAdoptionFramework/tree/master/ready/AzNamingTool",
                            "linkTarget": "Url",
                            "linkLabel": "(Azure Naming Tool)",
                            "preText": "",
                            "style": "link"
                          },
                          {
                            "id": "d9301c77-6984-489e-be44-1be75ba111fd",
                            "cellValue": "https://azuredevopsdemogenerator.azurewebsites.net/?name=strategyplan",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Azure Devops Project",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "e5d62f3b-7446-452b-8d91-2c5eb369dc87",
                            "cellValue": "https://raw.githubusercontent.com/microsoft/CloudAdoptionFramework/master/govern/security-baseline-discipline-template.docx",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Security Plan",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "dfc4e18f-0e77-4497-a62a-70e8666c1f22",
                            "cellValue": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-business-continuity-disaster-recovery",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Business Continuity and Disaster Recovery Plan",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "0689866f-6951-47e1-9b95-b84cdf0ea52e",
                            "cellValue": "https://raw.githubusercontent.com/microsoft/CloudAdoptionFramework/master/govern/identity-baseline-discipline-template.docx",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Identity Plan",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "81d3baa7-0297-4054-bc38-cb79ce92ea1e",
                            "cellValue": "https://raw.githubusercontent.com/microsoft/CloudAdoptionFramework/master/govern/cost-management-discipline-template.docx",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Cost Management Plan",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "f19e90dd-eddf-422f-b919-b55709b86761",
                            "cellValue": "https://raw.githubusercontent.com/Microsoft/CloudAdoptionFramework/master/manage/opsmanagementworkbook.xlsx",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Operations Management Workbook",
                            "preText": "07-06-2022",
                            "style": "link"
                          },
                          {
                            "id": "7023b265-1865-4199-b891-08362944827c",
                            "cellValue": "https://github.com/JulianHayward/Azure-MG-Sub-Governance-Reporting",
                            "linkTarget": "Url",
                            "linkLabel": "[Customer Name] Azure Governance Visualizer Map",
                            "preText": "07-06-2022",
                            "style": "link"
                          }
                        ]
                      },
                      "customWidth": "25",
                      "name": "links3",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "#### Enterprise Landing Zone\r\n\r\n[![Azure](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/media/ns-arch-cust-expanded.png#lightbox)](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/media/ns-arch-cust-expanded.png#lightbox)"
                      },
                      "customWidth": "50",
                      "name": "lz",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Documentation"
                },
                "name": "docs"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 1,
                      "content": {
                        "json": "The [Customer Name] cross-team responsible, accountable, consulted, and informed (RACI) matrix is based on the [Microsoft Cloud Adoption Framework RACI sample](https://raw.githubusercontent.com/microsoft/CloudAdoptionFramework/master/organize/raci-template.xlsx)."
                      },
                      "name": "text - 3"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "The RACI matrix should be customised to document the team assignment for at least the following task categories:\r\n\r\n- Compliance\r\n- Observability\r\n- Disaster Recovery\r\n- Reliability\r\n- Performance\r\n- Updates\r\n- Cost Management\r\n- Security\r\n- Inventory (Asset Management)\r\n- Operational Excellence\r\n- Automation\r\n\r\nNote: It is also possible that different teams will own the same task categroy RACI assignment across different platform resources, application resources/workloads and management services. Global operations may also have regional RACI assignments.",
                        "style": "info"
                      },
                      "conditionalVisibility": {
                        "parameterName": "ShowHelp",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "helptxt - Copy"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Legend\r\n|Item|Description|\r\n| ------------ | ------------ |\r\n|Accountable|The one person or team to be held accountable for results and outcomes|\r\n|Responsible|Any people or teams who are responsible for contributing to the results and outcomes|\r\n|Consulted|People or teams who should be consulted prior to changes being implemented|\r\n|Informed|People or teams who should be informed about changes|",
                        "style": "info"
                      },
                      "conditionalVisibility": {
                        "parameterName": "ShowHelp",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "text - 2"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/raci.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/raci.png)"
                      },
                      "customWidth": "85",
                      "name": "text - 5"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "RACI"
                },
                "name": "racigrp"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 1,
                            "content": {
                              "json": "A well-managed cloud is one that is managed for all of the items in the below list. This list represent an expansion of the 5 pillars of the [**Microsoft Azure Well-Architected Framework**](https://docs.microsoft.com/azure/architecture/framework/?WT.mc_id=Portal-fx), and are suggested as a framework for managing Azure environments.\r\n\r\n- Compliant (WAF: Security)\r\n- Observable (WAF: Operational Excellence)\r\n- Recoverable (WAF: Reliability)\r\n- Reliable (WAF: Reliability)\r\n- Performant (WAF: Performance)\r\n- Updateable (WAF: Reliability)\r\n- Cost Managed (WAF: Cost Management)\r\n- Secured (WAF: Security)\r\n- Inventoried (WAF: Operational Excellence)\r\n- Operational Excellence (WAF: Operational Excellence)\r\n\r\nActivities, alerts and policies for managing **services**, **platform** resources, **application** resources and **solutions** are presented for each of these items in this workbook. "
                            },
                            "name": "mgmtpills"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Compliant\r\nServices that can be used to manage compliance in Azure include:\r\n- Azure Devops Services\r\n- Github\r\n- Azure Policy\r\n- Defender for Cloud\r\n- Azure Monitor\r\n- Azure Resource Graph\r\n- In-guest VM Policy\r\n- Desired State Configuration\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/compliant.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/compliant.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "compliant"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Observable\r\nServices that can be used to manage observability in Azure include:\r\n- Azure Monitor\r\n- Log Analytics\r\n- Microsoft Sentinel\r\n- Defender for Cloud\r\n- AAD Audit and Sign-in\r\n- Activity Log\r\n- Network Watcher\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/observable.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/observable.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "observable"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Recoverable\r\nServices that can be used to manage recovery in Azure include:\r\n- Backup\r\n- Site Recovery\r\n- Devops Redeploy\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/recoverable.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/recoverable.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "recoverable"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Reliable\r\nServices that can be used to manage reliability in Azure include:\r\n- Advisor\r\n- Chaos Studio\r\n- Azure Monitor\r\n- Log Analytics\r\n- Workbooks\r\n- Alerts that prevent downtime or reduce MTTR\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/reliable.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/reliable.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "reliable"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Performant\r\nServices that can be used to manage performance in Azure include:\r\n- Advisor\r\n- Azure Monitor\r\n- Log Analytics\r\n- Microsoft Sentinel\r\n- Metrics\r\n- Workbooks\r\n- Network Watcher\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/performant.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/performant.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "performant"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Updateable\r\nServices that can be used to manage updates in Azure include:\r\n- Advisor\r\n- Customer managed via UM and LAWS\r\n- Planned maintenance (Service Health)\r\n- Devops Update\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/updateable.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/updateable.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "updateable"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Cost Managed\r\nServices that can be used to manage cost in Azure include:\r\n- Advisor\r\n- Cost Management & Billing\r\n- EA Portal (Account hierarchy, credit balance, cost for each department, account, and subscription)\r\n\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/cost.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/cost.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "cost"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Secured\r\nServices that can be used to manage security in Azure include:\r\n- Advisor\r\n- AAD\r\n- MFA\r\n- CA\r\n- PIM\r\n- Role Entitlement\r\n- Policy\r\n- In-Guest Policy\r\n- Network Watcher\r\n- Defender for Cloud\r\n- Microsoft Sentinel\r\n- Key Vault\r\n- DDoS\r\n- NSG\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/secure.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/secure.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "secured"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Inventoried\r\nServices that can be used to manage inventory in Azure include:\r\n- Resource graph\r\n- Defender for Cloud (Inventory)\r\n- Automation (Change Tracking & Inventory)\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/inventory.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/inventory.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "inventory"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Operational Excellence\r\nServices that can be used to provide operational excellence in Azure include:\r\n- Advisor\r\n- People\r\n- Process\r\n- RACI\r\n- Dashboards\r\n- Reports\r\n- Reviews\r\n- Automation (AA, LA, Functions)\r\n\r\n[![Azure](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/operationalexcellence.png)](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/operationalexcellence.png)",
                              "style": "upsell"
                            },
                            "customWidth": "20",
                            "name": "opsex"
                          }
                        ]
                      },
                      "name": "categorydetailgrp"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Example 1: Azure Virtual Desktop\r\nThe diagram below is a visual representation of the tags with tasks (activities, alerts and policies) applied to the management of an Azure Virtual Desktop solution.",
                        "style": "upsell"
                      },
                      "customWidth": "50",
                      "name": "avdtags"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Example 2: ExpressRoute\r\nThe diagram below is a visual representation of the tags with tasks (activities, alerts and policies) applied to the management of an ExpressRoute circuit.",
                        "style": "upsell"
                      },
                      "customWidth": "50",
                      "name": "avdtags - Copy"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "[<img src=\"https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/avd.png\"/>](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/avd.png)"
                      },
                      "customWidth": "50",
                      "name": "avdarc"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "[<img src=\"https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/exr.png\"/>](https://raw.githubusercontent.com/Azure/cloud-rolesandops/main/images/exr.png)"
                      },
                      "customWidth": "50",
                      "name": "exrarc"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "What is a Well-Managed Cloud?"
                },
                "name": "taskcats"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "selectedTab",
            "comparison": "isEqualTo",
            "value": "Service Management"
          },
          "name": "svcmgmt"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "This section provides a list of activities, alerts and policies that should be considered in an operations plan.\r\n\r\nWhile it may not be feasible to perform all tasks, any critical applications and business processes that rely on Azure resources should be managed for their availability, performance, security and operation."
                },
                "name": "text - 11"
              },
              {
                "type": 1,
                "content": {
                  "json": "## Category\r\n|Name   |Description   |\r\n| ------------ | ------------ |\r\n|Foundation|Tasks apply to across all services, platform, application and solution resources.|\r\n|Service|Tasks apply to services that are used to manage resources.|\r\n|Platform|Tasks apply to platform landing zone resources.|\r\n|Application|Tasks apply to application landing zone resources.|\r\n|Solution|Tasks apply to solutions that are managed as a unit across different resources e.g. AVS, AVD, SAP, etc.|\r\n",
                  "style": "info"
                },
                "customWidth": "25",
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "tasklegend2"
              },
              {
                "type": 1,
                "content": {
                  "json": "## Action\r\n|Name   |Description   |\r\n| ------------ | ------------ |\r\n|Activity|Manual task executed by a person.|\r\n|Alert|An alert rule that will automatically trigger if the condition(s) are met.|\r\n|Policy|A policy assignment that will apply action according to the defined policy effect.|",
                  "style": "info"
                },
                "customWidth": "25",
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "tasklegend2 - Copy"
              },
              {
                "type": 1,
                "content": {
                  "json": "## User Assigned Status\r\n|Name   |Description   |\r\n| ------------ | ------------ |\r\n|Closed|Task has been completed.|\r\n|Open   |Task has not been completed.|\r\n|Not Applicable|Task is not required currently.|\r\n|Retired|Task is no longer required.|",
                  "style": "info"
                },
                "customWidth": "25",
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "tasklegend1"
              },
              {
                "type": 1,
                "content": {
                  "json": "## System Assigned Status\r\n|Name   |Description   |\r\n| ------------ | ------------ |\r\n|Closed|Task has been completed.|\r\n|Open   |Task has not been completed, or is due again.|",
                  "style": "info"
                },
                "customWidth": "25",
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "tasklegend1 - Copy"
              },
              {
                "type": 1,
                "content": {
                  "json": "## Priority\r\n|Priority   |Description   |\r\n| ------------ | ------------ |\r\n|High|User assignable priority.|\r\n|Medium|User assignable priority.|\r\n|Low|User assignable priority.|",
                  "style": "info"
                },
                "customWidth": "25",
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "tasklegend5"
              },
              {
                "type": 1,
                "content": {
                  "json": "## Mode\r\n|Name   |Description   |\r\n| ------------ | ------------ |\r\n|Automated|Task has been automated including infrastructure-as-code, alert rules, policy, etc.|\r\n|Manual|Manual task.|",
                  "style": "info"
                },
                "customWidth": "25",
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "tasklegend3"
              },
              {
                "type": 1,
                "content": {
                  "json": "## Frequency\r\n|Name   |Description   |\r\n| ------------ | ------------ |\r\n|Ad hoc|Task is performed when required.|\r\n|Once|One-off task, but reviewed within 365 days.|\r\n|Daily|Task performed on a daily basis.|\r\n|Weekly|Task performed on a weekly basis.|\r\n|Monthly|Task performed on a monthly basis.|\r\n|Yearly|Task performed on a yearly basis.|",
                  "style": "info"
                },
                "customWidth": "25",
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "tasklegend4"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "parameters": [
                    {
                      "id": "b9a9be57-50ff-4e67-9d6c-7d66c9729872",
                      "version": "KqlParameterItem/1.0",
                      "name": "category",
                      "label": "Category",
                      "type": 2,
                      "description": "Navigate to foundation, service, platform, application or solution tasks",
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| distinct Category \r\n| sort by Category asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces"
                    },
                    {
                      "id": "c9a67fdb-4a6f-4bc6-894b-a7996d63e172",
                      "version": "KqlParameterItem/1.0",
                      "name": "technology",
                      "label": "Technology",
                      "type": 2,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| distinct technology_s \r\n| sort by technology_s asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "value": [
                        "value::all"
                      ]
                    },
                    {
                      "id": "b3c24fe1-a7fd-4d40-8e29-c288177648cc",
                      "version": "KqlParameterItem/1.0",
                      "name": "tags",
                      "label": "Tags",
                      "type": 2,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| distinct tags_s \r\n| sort by tags_s asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "value": [
                        "value::all"
                      ]
                    },
                    {
                      "id": "e6de3d87-b702-4fd9-94f6-4d84978a8380",
                      "version": "KqlParameterItem/1.0",
                      "name": "status",
                      "label": "Status",
                      "type": 2,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| distinct systemAssignedStatus_s \r\n| sort by systemAssignedStatus_s asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces"
                    },
                    {
                      "id": "dd8d4360-9b95-46f6-a966-5c89bf16aad2",
                      "version": "KqlParameterItem/1.0",
                      "name": "priority",
                      "label": "Priority",
                      "type": 2,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status}) \r\n| distinct priority_s \r\n| sort by priority_s asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces"
                    },
                    {
                      "id": "4e5ab20a-24ac-41e8-87e3-8efdc0bb5176",
                      "version": "KqlParameterItem/1.0",
                      "name": "frequency",
                      "label": "Frequency",
                      "type": 2,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status}) \r\n| where priority_s in ({priority}) \r\n| distinct frequency_s \r\n| sort by frequency_s asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces"
                    },
                    {
                      "id": "cef8bb3b-825d-4c80-8390-e06f3f2c6837",
                      "version": "KqlParameterItem/1.0",
                      "name": "responsible",
                      "label": "Responsible",
                      "type": 2,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "jsonData": "[{ \"value\": \"CS\", \"label\": \"Cloud strategy team\", \"selected\":true },\r\n {\"value\": \"CG\", \"label\": \"Cloud governance team\"},\r\n {\"value\": \"CO\", \"label\": \"Cloud operations team\"},\r\n {\"value\": \"CP\", \"label\": \"Cloud platform team\"},\r\n {\"value\": \"CA\", \"label\": \"Cloud adoption team\"},\r\n {\"value\": \"CAU\", \"label\": \"Cloud automation team\"},\r\n {\"value\": \"SAP\", \"label\": \"Cloud SAP team\"},\r\n {\"value\": \"All teams\", \"label\": \"'All teams'\"}]\r\n\r\n \r\n\r\n\r\n\r\n\r\n\r\n",
                      "defaultValue": "value::all"
                    },
                    {
                      "id": "1a993af9-0cf6-47cf-9e10-d7e2d10433bb",
                      "version": "KqlParameterItem/1.0",
                      "name": "accountable",
                      "label": "Accountable",
                      "type": 2,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "jsonData": "[{ \"value\": \"CS\", \"label\": \"Cloud strategy team\", \"selected\":true },\r\n {\"value\": \"CG\", \"label\": \"Cloud governance team\"},\r\n {\"value\": \"CO\", \"label\": \"Cloud operations team\"},\r\n {\"value\": \"CP\", \"label\": \"Cloud platform team\"},\r\n {\"value\": \"CA\", \"label\": \"Cloud adoption team\"},\r\n {\"value\": \"SAP\", \"label\": \"Cloud SAP team\"},\r\n {\"value\": \"CAU\", \"label\": \"Cloud automation team\"}]\r\n\r\n \r\n\r\n\r\n\r\n\r\n\r\n",
                      "defaultValue": "value::all"
                    }
                  ],
                  "style": "pills",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                "name": "parameters - 11"
              },
              {
                "type": 1,
                "content": {
                  "json": "Task selection:\r\n- Category: {category}\r\n- Technology: {technology}\r\n- Tags: {tags}\r\n- Status: {status}\r\n- Priority: {priority}\r\n- Frequency: {frequency}\r\n- Responsible: {responsible}\r\n- Accountable: {accountable}",
                  "style": "info"
                },
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "selectionstep"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| extend dayDiff=toint(toint(systemAssignedFrequencyDays_s) - toint(systemAssignedDaysSinceDateCompleted_s))*1d\r\n| extend systemKqlAssignedDateNext = \r\n    iif(userAssignedStatus_s == \"Retired\" or userAssignedStatus_s == \"Not Applicable\" or frequency_s == \"Ad hoc\", \r\n    todatetime(now(+365d)), \r\n        iif(toint(systemAssignedDaysSinceDateCompleted_s) > 44000, \r\n        todatetime(now()), \r\n        todatetime(now(dayDiff))\r\n        )\r\n    )\r\n| project category=Category, Type=technology_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, systemKqlAssignedDateNext, Priority=priority_s, Mode=mode_s, Freq=frequency_s, Responsible=responsible_s, Accountable=accountable_s, Consulted=consulted_s, Informed=informed_s, Tags=tags_s, dateDefined_s, dateCompleted_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Notes=notes_s\r\n| sort by category asc, Type asc, Id asc\r\n",
                  "size": 3,
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "visualization": "table",
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "$gen_group",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "40ch"
                        }
                      },
                      {
                        "columnMatch": "category",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Type",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Id",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "10ch"
                        }
                      },
                      {
                        "columnMatch": "Action",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "Activity",
                              "representation": "Person",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Alert",
                              "representation": "Alert",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Policy",
                              "representation": "Check",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": null,
                              "text": "{0}{1}"
                            }
                          ],
                          "customColumnWidthSetting": "10ch"
                        }
                      },
                      {
                        "columnMatch": "Task",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "90ch"
                        }
                      },
                      {
                        "columnMatch": "Status",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "Open",
                              "representation": "Sev0",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Closed",
                              "representation": "Sev4",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Retired",
                              "representation": "Sev3",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Recurring",
                              "representation": "Sev2",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": null,
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "systemKqlAssignedDateNext",
                        "formatter": 6
                      },
                      {
                        "columnMatch": "Priority",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "High",
                              "representation": "Sev0",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Medium",
                              "representation": "Sev1",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Low",
                              "representation": "Sev2",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "more",
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "Mode",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "Automated",
                              "representation": "Code",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Manual",
                              "representation": "Backlog",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "more",
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "Responsible",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        }
                      },
                      {
                        "columnMatch": "Accountable",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        }
                      },
                      {
                        "columnMatch": "Consulted",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        }
                      },
                      {
                        "columnMatch": "Informed",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        }
                      },
                      {
                        "columnMatch": "Tags",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "dateDefined_s",
                        "formatter": 6
                      },
                      {
                        "columnMatch": "dateCompleted_s",
                        "formatter": 6
                      },
                      {
                        "columnMatch": "Url1",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "Url",
                          "customColumnWidthSetting": "25ch"
                        }
                      },
                      {
                        "columnMatch": "Url2",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "Url",
                          "customColumnWidthSetting": "25ch"
                        }
                      },
                      {
                        "columnMatch": "Notes",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        }
                      },
                      {
                        "columnMatch": "$gen_group",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "40ch"
                        }
                      },
                      {
                        "columnMatch": "systemAssignedDateNext_s",
                        "formatter": 6
                      },
                      {
                        "columnMatch": "TimeGenerated",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "TenantId",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "SourceSystem",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "MG",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "ManagementGroupName",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Computer",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "RawData",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "_ResourceId",
                        "formatter": 5
                      }
                    ],
                    "rowLimit": 5000,
                    "filter": true,
                    "hierarchySettings": {
                      "treeType": 1,
                      "groupBy": [
                        "category",
                        "Type",
                        "Tags"
                      ],
                      "expandTopLevel": true,
                      "finalBy": "Id"
                    },
                    "labelSettings": [
                      {
                        "columnId": "category",
                        "label": "Category"
                      },
                      {
                        "columnId": "systemKqlAssignedDateNext",
                        "label": "Date Next (system)"
                      },
                      {
                        "columnId": "dateDefined_s",
                        "label": "Date Defined (user)"
                      },
                      {
                        "columnId": "dateCompleted_s",
                        "label": "Date Completed (user)"
                      }
                    ]
                  }
                },
                "name": "taskstep"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 1,
                      "content": {
                        "json": "## Task Metrics"
                      },
                      "name": "title"
                    },
                    {
                      "type": 9,
                      "content": {
                        "version": "KqlParameterItem/1.0",
                        "parameters": [
                          {
                            "id": "b3f76dea-2d0c-4697-818d-5add8936ec76",
                            "version": "KqlParameterItem/1.0",
                            "name": "TaskMetrics",
                            "label": "View task metrics by",
                            "type": 10,
                            "isRequired": true,
                            "multiSelect": true,
                            "quote": "",
                            "delimiter": ",",
                            "typeSettings": {
                              "additionalResourceOptions": [],
                              "showDefault": false
                            },
                            "jsonData": "[[{ \"value\": \"category\", \"label\": \"Category\", \"selected\":true },\r\n {\"value\": \"Type\", \"label\": \"Technology\"},\r\n {\"value\": \"Tag\", \"label\": \"Tag\"},\r\n {\"value\": \"Action\", \"label\": \"Action\"},\r\n {\"value\": \"Mode\", \"label\": \"Mode\"},\r\n {\"value\": \"Freq\", \"label\": \"Frequency\"},\r\n {\"value\": \"Status\", \"label\": \"Status\"},\r\n {\"value\": \"Priority\", \"label\": \"Priority\"},\r\n {\"value\": \"Responsible\", \"label\": \"Responsible\"},\r\n {\"value\": \"Accountable\", \"label\": \"Accountable\"}]",
                            "timeContext": {
                              "durationMs": 86400000
                            },
                            "value": "Type"
                          }
                        ],
                        "style": "formVertical",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      "name": "parameters - 8"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL | summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| project Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, R=responsible_s, A=accountable_s, C=consulted_s, I=informed_s\r\n| summarize \r\n    TotalTasks = count(Id),\r\n    OpenTasks = dcountif(Id, Status==\"Open\"),\r\n    ClosedTasks = dcountif(Id, Status==\"Closed\"),\r\n    NATasks = dcountif(Id, Status==\"Not Applicable\"),\r\n    RetiredTasks = dcountif(Id, Status==\"Retired\"),\r\n    TotalOutstandingTasks = count(Id) - (dcountif(Id, Status==\"Closed\")) - (dcountif(Id, Status==\"Not Applicable\")) - (dcountif(Id, Status==\"Retired\")),\r\n    pctCompletedTasks = (toreal(dcountif(Id, Status==\"Closed\")) / toreal(count(Id) - (dcountif(Id, Status==\"Not Applicable\")) - (dcountif(Id, Status==\"Retired\"))))*100\r\n| project toint(pctCompletedTasks)",
                        "size": 3,
                        "title": "Completed Tasks",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "pctCompletedTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "pctOpenTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "warning",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "pctOutstanding",
                              "formatter": 0,
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "pctCompleted",
                              "formatter": 0,
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "technology_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "120ch"
                              }
                            },
                            {
                              "columnMatch": "action_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "pctCompletedTasks",
                              "label": "Completed Tasks"
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "pctCompletedTasks",
                            "formatter": 4,
                            "formatOptions": {
                              "min": 0,
                              "max": 100,
                              "palette": "hotCold"
                            },
                            "numberFormat": {
                              "unit": 1,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "15",
                      "name": "pctcompleteopenstep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project Category, Type=technology_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Responsible=responsible_s, Accountable=accountable_s, Consulted=consulted_s, Informed=informed_s, Tags=tags_s\r\n| summarize count() by Category\r\n| order by Category asc\r\n",
                        "size": 3,
                        "title": "Tasks by Category",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type",
                              "Tags"
                            ],
                            "expandTopLevel": true
                          }
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Category",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "category"
                      },
                      "name": "navtaskstep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project category=Category, Type=technology_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Responsible=responsible_s, Accountable=accountable_s, Consulted=consulted_s, Informed=informed_s, Tags=tags_s\r\n| summarize count() by Type\r\n| order by Type asc\r\n",
                        "size": 3,
                        "title": "Tasks by Technology",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type",
                              "Tags"
                            ],
                            "expandTopLevel": true
                          }
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Type"
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Type"
                      },
                      "name": "typetaskstep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| summarize count() by tags_s\r\n| order by tags_s asc",
                        "size": 3,
                        "title": "Tasks by Tag",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Yes",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "No",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "200ch"
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "tags_s",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Tag"
                      },
                      "name": "tagsstep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project category=Category, Type=technology_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Responsible=responsible_s, Accountable=accountable_s, Consulted=consulted_s, Informed=informed_s, Tags=tags_s\r\n| summarize count() by Action\r\n| order by Action asc\r\n",
                        "size": 3,
                        "title": "Tasks by Action",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type",
                              "Tags"
                            ],
                            "expandTopLevel": true
                          }
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Action",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Action"
                      },
                      "name": "taskactionstep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project category=Category, Type=technology_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Responsible=responsible_s, Accountable=accountable_s, Consulted=consulted_s, Informed=informed_s, Tags=tags_s\r\n| summarize count() by Mode\r\n| order by Mode asc\r\n",
                        "size": 3,
                        "title": "Tasks by Mode",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type",
                              "Tags"
                            ],
                            "expandTopLevel": true
                          }
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Mode",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Mode"
                      },
                      "name": "taskmodestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project category=Category, Type=technology_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Responsible=responsible_s, Accountable=accountable_s, Consulted=consulted_s, Informed=informed_s, Tags=tags_s\r\n| summarize count() by Freq\r\n| order by Freq asc\r\n",
                        "size": 3,
                        "title": "Tasks by Frequency",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "20ch"
                              }
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type",
                              "Tags"
                            ],
                            "expandTopLevel": true
                          }
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Freq",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Freq"
                      },
                      "name": "taskfreqstep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, R=responsible_s, A=accountable_s, C=consulted_s, I=informed_s\r\n| summarize count() by Status\r\n| order by Status asc\r\n",
                        "size": 3,
                        "title": "Tasks by Status",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "technology_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "120ch"
                              }
                            },
                            {
                              "columnMatch": "action_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Status",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Status"
                      },
                      "name": "totalbystatestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Priority=priority_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, R=responsible_s, A=accountable_s, C=consulted_s, I=informed_s\r\n| summarize count() by Priority\r\n| order by Priority asc",
                        "size": 3,
                        "title": "Tasks by Priority",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "technology_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "120ch"
                              }
                            },
                            {
                              "columnMatch": "action_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Priority",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "contains",
                                  "thresholdValue": "High",
                                  "representation": "Sev0",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Medium",
                                  "representation": "Sev1",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Low",
                                  "representation": "Sev2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Sev4",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Priority"
                      },
                      "name": "totalbyprioritystep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Priority=priority_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, R=responsible_s, A=accountable_s, C=consulted_s, I=informed_s\r\n| summarize count() by R\r\n| order by R asc\r\n",
                        "size": 3,
                        "title": "Tasks by Responsible",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "technology_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "120ch"
                              }
                            },
                            {
                              "columnMatch": "action_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "R",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Responsible"
                      },
                      "name": "totalbyresponsiblestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s in ({tags})\r\n| where systemAssignedStatus_s in ({status})\r\n| where priority_s in ({priority})\r\n| where frequency_s in ({frequency})\r\n| where responsible_s in ({responsible})\r\n| where accountable_s in ({accountable})\r\n| project Id=systemAssignedId_s, Action=action_s, Task=task_s, Status=systemAssignedStatus_s, Priority=priority_s, Mode=mode_s, Freq=frequency_s, Notes=notes_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, R=responsible_s, A=accountable_s, C=consulted_s, I=informed_s\r\n| summarize count() by A\r\n| order by A asc\r\n",
                        "size": 3,
                        "title": "Tasks by Accountable",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "tiles",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "technology_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "120ch"
                              }
                            },
                            {
                              "columnMatch": "action_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "yellow",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "grayBlue",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "A",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "customWidth": "85",
                      "conditionalVisibility": {
                        "parameterName": "TaskMetrics",
                        "comparison": "isEqualTo",
                        "value": "Accountable"
                      },
                      "name": "totalbyaccountablestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "name": "taskinfogrp"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "selectedTab",
            "comparison": "isEqualTo",
            "value": "Task Definitions"
          },
          "name": "tasksgrp"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "Initiative definitions are aligned to the five [**Microsoft Well-Architected Framework**](https://docs.microsoft.com/en-us/azure/architecture/framework/) pillars and can be used as part of a **coordinated effort to improve an area of operations**. "
                },
                "name": "text - 9"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "parameters": [
                    {
                      "id": "b9a9be57-50ff-4e67-9d6c-7d66c9729872",
                      "version": "KqlParameterItem/1.0",
                      "name": "category",
                      "label": "Category",
                      "type": 2,
                      "description": "Navigate to foundation, service, platform, application or solution tasks",
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| distinct Category \r\n| sort by Category asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "value": [
                        "value::all"
                      ]
                    },
                    {
                      "id": "c9a67fdb-4a6f-4bc6-894b-a7996d63e172",
                      "version": "KqlParameterItem/1.0",
                      "name": "technology",
                      "label": "Technology",
                      "type": 2,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "CloudOpsv3_CL\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| distinct technology_s \r\n| sort by technology_s asc",
                      "crossComponentResources": [
                        "{Workspace}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::all",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "value": [
                        "value::all"
                      ]
                    }
                  ],
                  "style": "pills",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                "name": "parameters - 11"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "parameters": [
                    {
                      "id": "5862a24c-8aed-49c0-b4e9-6bca33ba93e9",
                      "version": "KqlParameterItem/1.0",
                      "name": "Initiative",
                      "label": "Select an Initiative",
                      "type": 10,
                      "isRequired": true,
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "jsonData": "[[\r\n { \"value\": \"Cost Optimization\", \"label\": \"Cost Optimization\", \"selected\":true },\r\n {\"value\": \"Operational Excellence\", \"label\": \"Operational Excellence\"},\r\n {\"value\": \"Performance Efficiency\", \"label\": \"Performance Efficiency\"},\r\n {\"value\": \"Reliability\", \"label\": \"Reliability\"},\r\n {\"value\": \"Security\", \"label\": \"Security\"}\r\n]",
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "value": "Reliability"
                    }
                  ],
                  "style": "formVertical",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                "name": "parameters - 4"
              },
              {
                "type": 1,
                "content": {
                  "json": "Task selection:\r\n- Category: {category}\r\n- Technology: {technology}",
                  "style": "info"
                },
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "selectionstep"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s == \"Cost Managed\"\r\n| extend dayDiff=toint(toint(systemAssignedFrequencyDays_s) - toint(systemAssignedDaysSinceDateCompleted_s))*1d\r\n| extend systemKqlAssignedDateNext = \r\n    iif(userAssignedStatus_s == \"Retired\" or userAssignedStatus_s == \"Not Applicable\" or frequency_s == \"Ad hoc\", \r\n    todatetime(now(+365d)), \r\n        iif(toint(systemAssignedDaysSinceDateCompleted_s) > 44000, \r\n        todatetime(now()), \r\n        todatetime(now(dayDiff))\r\n        )\r\n    )\r\n| project category=Category, Type=technology_s, Tags=tags_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Priority=priority_s, Mode=mode_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Notes=notes_s\r\n| sort by category asc, Type asc, Id asc\r\n",
                        "size": 3,
                        "title": "Cost Optimization",
                        "showExportToExcel": true,
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Cost Managed",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 5,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "Person",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "Check",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Tasks",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "90ch"
                              }
                            },
                            {
                              "columnMatch": "Priority",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemKqlAssignedDateNext",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "systemAssignedDateNext_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "filter": true,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type"
                            ],
                            "expandTopLevel": true,
                            "finalBy": "Id"
                          },
                          "labelSettings": [
                            {
                              "columnId": "category",
                              "label": "Category"
                            }
                          ]
                        }
                      },
                      "showPin": true,
                      "name": "costtaskstep"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "Initiative",
                  "comparison": "isEqualTo",
                  "value": "Cost Optimization"
                },
                "name": "group - 10",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s == \"Operational Excellence\" or tags_s == \"Inventoried\"\r\n| extend dayDiff=toint(toint(systemAssignedFrequencyDays_s) - toint(systemAssignedDaysSinceDateCompleted_s))*1d\r\n| extend systemKqlAssignedDateNext = \r\n    iif(userAssignedStatus_s == \"Retired\" or userAssignedStatus_s == \"Not Applicable\" or frequency_s == \"Ad hoc\", \r\n    todatetime(now(+365d)), \r\n        iif(toint(systemAssignedDaysSinceDateCompleted_s) > 44000, \r\n        todatetime(now()), \r\n        todatetime(now(dayDiff))\r\n        )\r\n    )\r\n| project category=Category, Type=technology_s, Tags=tags_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Priority=priority_s, Mode=mode_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Notes=notes_s\r\n| sort by category asc, Type asc, Id asc\r\n",
                        "size": 3,
                        "title": "Operational Excellence",
                        "showExportToExcel": true,
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Operational Excellence",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Inventoried",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Observable",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 5,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "Person",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "Check",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Tasks",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "90ch"
                              }
                            },
                            {
                              "columnMatch": "Priority",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "-- Group By --",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemKqlAssignedDateNext",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "systemAssignedDateNext_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "filter": true,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type"
                            ],
                            "expandTopLevel": true,
                            "finalBy": "Id"
                          },
                          "labelSettings": [
                            {
                              "columnId": "category",
                              "label": "Category"
                            }
                          ]
                        }
                      },
                      "showPin": true,
                      "name": "opextaskstep"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "Initiative",
                  "comparison": "isEqualTo",
                  "value": "Operational Excellence"
                },
                "name": "group - 10",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s == \"Performant\"\r\n| extend dayDiff=toint(toint(systemAssignedFrequencyDays_s) - toint(systemAssignedDaysSinceDateCompleted_s))*1d\r\n| extend systemKqlAssignedDateNext = \r\n    iif(userAssignedStatus_s == \"Retired\" or userAssignedStatus_s == \"Not Applicable\" or frequency_s == \"Ad hoc\", \r\n    todatetime(now(+365d)), \r\n        iif(toint(systemAssignedDaysSinceDateCompleted_s) > 44000, \r\n        todatetime(now()), \r\n        todatetime(now(dayDiff))\r\n        )\r\n    )\r\n| project category=Category, Type=technology_s, Tags=tags_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Priority=priority_s, Mode=mode_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Notes=notes_s\r\n| sort by category asc, Type asc, Id asc\r\n",
                        "size": 3,
                        "title": "Performance Efficiency",
                        "showExportToExcel": true,
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Performant",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 5,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "Person",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "Check",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Tasks",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "90ch"
                              }
                            },
                            {
                              "columnMatch": "Priority",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "-- Group By --",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemKqlAssignedDateNext",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "systemAssignedDateNext_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "filter": true,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type"
                            ],
                            "expandTopLevel": true,
                            "finalBy": "Id"
                          },
                          "labelSettings": [
                            {
                              "columnId": "category",
                              "label": "Category"
                            }
                          ]
                        }
                      },
                      "showPin": true,
                      "name": "perftaskstep"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "Initiative",
                  "comparison": "isEqualTo",
                  "value": "Performance Efficiency"
                },
                "name": "group - 10",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s == \"Reliable\" or tags_s == \"Recoverable\" or tags_s == \"Updateable\"\r\n| extend dayDiff=toint(toint(systemAssignedFrequencyDays_s) - toint(systemAssignedDaysSinceDateCompleted_s))*1d\r\n| extend systemKqlAssignedDateNext = \r\n    iif(userAssignedStatus_s == \"Retired\" or userAssignedStatus_s == \"Not Applicable\" or frequency_s == \"Ad hoc\", \r\n    todatetime(now(+365d)), \r\n        iif(toint(systemAssignedDaysSinceDateCompleted_s) > 44000, \r\n        todatetime(now()), \r\n        todatetime(now(dayDiff))\r\n        )\r\n    )\r\n| project category=Category, Type=technology_s, Tags=tags_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Priority=priority_s, Mode=mode_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Notes=notes_s\r\n| sort by category asc, Type asc, Id asc\r\n",
                        "size": 3,
                        "title": "Reliability",
                        "showExportToExcel": true,
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Reliable",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Updateable",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recoverable",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 5,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "Person",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "Check",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Tasks",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "90ch"
                              }
                            },
                            {
                              "columnMatch": "Priority",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemKqlAssignedDateNext",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "systemAssignedDateNext_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "filter": true,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type"
                            ],
                            "expandTopLevel": true,
                            "finalBy": "Id"
                          },
                          "labelSettings": [
                            {
                              "columnId": "category",
                              "label": "Category"
                            }
                          ]
                        }
                      },
                      "showPin": true,
                      "name": "reliabletaskstep"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "Initiative",
                  "comparison": "isEqualTo",
                  "value": "Reliability"
                },
                "name": "group - 10",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL \r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| where Category in ({category})\r\n| where technology_s in ({technology})\r\n| where tags_s == \"Secured\" or tags_s == \"Compliant\"\r\n| extend dayDiff=toint(toint(systemAssignedFrequencyDays_s) - toint(systemAssignedDaysSinceDateCompleted_s))*1d\r\n| extend systemKqlAssignedDateNext = \r\n    iif(userAssignedStatus_s == \"Retired\" or userAssignedStatus_s == \"Not Applicable\" or frequency_s == \"Ad hoc\", \r\n    todatetime(now(+365d)), \r\n        iif(toint(systemAssignedDaysSinceDateCompleted_s) > 44000, \r\n        todatetime(now()), \r\n        todatetime(now(dayDiff))\r\n        )\r\n    )\r\n| project category=Category, Type=technology_s, Tags=tags_s, Id=systemAssignedId_s, Action=action_s, Task=task_s, Priority=priority_s, Mode=mode_s, Url1=referenceUrl1_s, Url2=referenceUrl2_s, Notes=notes_s\r\n| sort by category asc, Type asc, Id, Tags asc\r\n",
                        "size": 3,
                        "title": "Security",
                        "showExportToExcel": true,
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Type",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Tags",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Secured",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Compliant",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Id",
                              "formatter": 5,
                              "formatOptions": {
                                "customColumnWidthSetting": "10ch"
                              }
                            },
                            {
                              "columnMatch": "Action",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Activity",
                                    "representation": "Person",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Alert",
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Policy",
                                    "representation": "Check",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Task",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Tasks",
                                    "text": "{0}{1}"
                                  }
                                ],
                                "customColumnWidthSetting": "90ch"
                              }
                            },
                            {
                              "columnMatch": "Priority",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Mode",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Automated",
                                    "representation": "Code",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Manual",
                                    "representation": "Backlog",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Url1",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Url2",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Notes",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "40ch"
                              }
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemKqlAssignedDateNext",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "Responsible",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Accountable",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Consulted",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "Informed",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "25ch"
                              }
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "systemAssignedDateNext_s",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 5000,
                          "filter": true,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "category",
                              "Type"
                            ],
                            "expandTopLevel": true,
                            "finalBy": "Id"
                          },
                          "labelSettings": [
                            {
                              "columnId": "category",
                              "label": "Category"
                            }
                          ]
                        }
                      },
                      "showPin": true,
                      "name": "securedtaskstep"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "Initiative",
                  "comparison": "isEqualTo",
                  "value": "Security"
                },
                "name": "group - 10",
                "styleSettings": {
                  "showBorder": true
                }
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "selectedTab",
            "comparison": "isEqualTo",
            "value": "Initiative Definitions"
          },
          "name": "initiativegrp"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "ðŸ’¡_Set the subscription and log analytics workspace that contain the Microsoft Sentinel instance that is to be assessed._"
                },
                "name": "text - 12"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "parameters": [
                    {
                      "id": "8ac362f6-5775-4880-ac36-688e0cfcd89e",
                      "version": "KqlParameterItem/1.0",
                      "name": "mssubscription",
                      "label": "Microsoft Sentinel Subscription",
                      "type": 6,
                      "isRequired": true,
                      "value": "",
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "includeAll": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      }
                    },
                    {
                      "id": "1f163416-d46e-42a3-9d2b-6356eb07122b",
                      "version": "KqlParameterItem/1.0",
                      "name": "msworkspace",
                      "label": "Microsoft Sentinel Workspace",
                      "type": 5,
                      "isRequired": true,
                      "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| project id",
                      "crossComponentResources": [
                        "{mssubscription}"
                      ],
                      "value": "",
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    },
                    {
                      "id": "fa1a0e31-8182-4918-8ec8-6c1a785613db",
                      "version": "KqlParameterItem/1.0",
                      "name": "timerange",
                      "label": "Time Range",
                      "type": 4,
                      "value": {
                        "durationMs": 7776000000
                      },
                      "typeSettings": {
                        "selectableValues": [
                          {
                            "durationMs": 86400000
                          },
                          {
                            "durationMs": 604800000
                          },
                          {
                            "durationMs": 1209600000
                          },
                          {
                            "durationMs": 2592000000
                          },
                          {
                            "durationMs": 7776000000
                          }
                        ]
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      }
                    }
                  ],
                  "style": "pills",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                "name": "parameters - 3 - Copy"
              },
              {
                "type": 1,
                "content": {
                  "json": "Note: The workbook will need to be modified to exclude Microsoft Sentinel if it is not used in the environment.",
                  "style": "warning"
                },
                "conditionalVisibility": {
                  "parameterName": "ShowHelp",
                  "comparison": "isEqualTo",
                  "value": "Yes"
                },
                "name": "text - 14"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "CloudOpsv3_CL | summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| extend technology_s=replace_string(technology_s, 'All Types', 'Foundation')\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| summarize \r\n    ManagementScore=toint((toreal(dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Closed\")))/toreal(count(systemAssignedId_s)))*100),\r\n    TotalTasks=count(systemAssignedId_s),\r\n    OpenTasks=dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Open\")),\r\n    ClosedTasks=dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Closed\"))\r\n| project key=1, Task=ManagementScore",
                  "size": 3,
                  "title": "Task Management Score (rollup) - merge",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "visualization": "table",
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "ManagementScore",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "50ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "TimeGenerated",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "TenantId",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "SourceSystem",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "MG",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "ManagementGroupName",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Computer",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "RawData",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "taskSet_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "dateDefined_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "dateCompleted_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "taskDue_s",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "colors",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "Yes",
                              "representation": "orange",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "No",
                              "representation": "green",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": null,
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "systemAssignedStatus_s",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "colors",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "Open",
                              "representation": "orange",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Closed",
                              "representation": "green",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Retired",
                              "representation": "gray",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Recurring",
                              "representation": "turquoise",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Not Applicable",
                              "representation": "purple",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "blue",
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "Category",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "tags_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "task_s",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "200ch"
                        }
                      },
                      {
                        "columnMatch": "frequencyDays_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "daysSinceDateCompleted_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "referenceUrl1_s",
                        "formatter": 7
                      },
                      {
                        "columnMatch": "referenceUrl2_s",
                        "formatter": 7
                      },
                      {
                        "columnMatch": "_ResourceId",
                        "formatter": 5
                      }
                    ]
                  },
                  "tileSettings": {
                    "titleContent": {
                      "columnMatch": "tags_s",
                      "formatter": 1
                    },
                    "leftContent": {
                      "columnMatch": "count_",
                      "formatter": 12,
                      "formatOptions": {
                        "palette": "auto"
                      }
                    },
                    "showBorder": false,
                    "size": "auto"
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hidden"
                },
                "name": "taskscorerollupstep - merge",
                "styleSettings": {
                  "margin": "2px",
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "//totalresources\r\nresources \r\n| summarize resourcetotal=count()\r\n| project key=1, resourcetotal\r\n| join\r\n//distinct resources with an advisor recommendation\r\n(advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| distinct tostring(properties.impactedValue)\r\n| summarize advisoraffectedresourcetotal=count()\r\n| project key=1, advisoraffectedresourcetotal) on key\r\n//what % resources of total resources do not have a recommendation? == the advisor management score\r\n| project pctnotaffected=toint(100-(toreal(advisoraffectedresourcetotal)/toreal(resourcetotal))*100), resourcetotal, advisoraffectedresourcetotal\r\n| project key=1, Advisor = pctnotaffected",
                  "size": 4,
                  "title": "Technology Management Score - Azure Advisor - merge",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "visualization": "table",
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "advisoraffectedresourcetotal",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "40ch"
                        }
                      },
                      {
                        "columnMatch": "pctnotaffected",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "40ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "ManagementScore",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "50ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "TimeGenerated",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "TenantId",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "SourceSystem",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "MG",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "ManagementGroupName",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Computer",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "RawData",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "taskSet_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "dateDefined_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "dateCompleted_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "taskDue_s",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "colors",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "Yes",
                              "representation": "orange",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "No",
                              "representation": "green",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": null,
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "systemAssignedStatus_s",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "colors",
                          "thresholdsGrid": [
                            {
                              "operator": "contains",
                              "thresholdValue": "Open",
                              "representation": "orange",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Closed",
                              "representation": "green",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Retired",
                              "representation": "gray",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Recurring",
                              "representation": "turquoise",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "contains",
                              "thresholdValue": "Not Applicable",
                              "representation": "purple",
                              "text": "{0}{1}"
                            },
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "blue",
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "Category",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "tags_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "task_s",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "200ch"
                        }
                      },
                      {
                        "columnMatch": "frequencyDays_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "daysSinceDateCompleted_s",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "referenceUrl1_s",
                        "formatter": 7
                      },
                      {
                        "columnMatch": "referenceUrl2_s",
                        "formatter": 7
                      },
                      {
                        "columnMatch": "_ResourceId",
                        "formatter": 5
                      }
                    ]
                  },
                  "tileSettings": {
                    "titleContent": {
                      "columnMatch": "tags_s",
                      "formatter": 1
                    },
                    "leftContent": {
                      "columnMatch": "count_",
                      "formatter": 12,
                      "formatOptions": {
                        "palette": "auto"
                      }
                    },
                    "showBorder": false,
                    "size": "auto"
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hidden"
                },
                "name": "advisorscorestep - merge",
                "styleSettings": {
                  "margin": "2px",
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "resources\r\n| where type in~ ('microsoft.compute/virtualmachines','microsoft.classiccompute/virtualmachines') \r\n| extend resourceId=tolower(id) \r\n| join kind = leftouter ( recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| project resourceId = tolower(tostring(properties.sourceResourceId)), backupItemid = id, isBackedUp = isnotempty(id) ) on resourceId \r\n| extend isProtected = isnotempty(backupItemid)\r\n| project id,name,resourceGroup,location,tags, tostring(isProtected)\r\n//| summarize count() by isProtected\r\n| summarize\r\n    VMTotal=toreal(count(id)),\r\n    Protected=toreal(dcountif(id, isProtected==\"True\")),\r\n    Unprotected=toreal(dcountif(id, isProtected==\"False\"))\r\n| project pctNotBackedUp=toint((Unprotected/VMTotal)*100), pctBackedUp=toint((Protected/VMTotal)*100), VMTotal, Protected, Unprotected\r\n| project key=1, Backup=pctBackedUp",
                  "size": 4,
                  "title": "Technology Management Score - Azure Backup - merge",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "pctNotBackedUp",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "pctBackedUp",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "40ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      }
                    ]
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hidden"
                },
                "name": "backupscorestep - merge",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "//if fired alerts <> 0, with less than 20% closed, then flag1 is true -33.3%\r\n//if fired alerts <> 0, with less than 50% acknowledged, then flag2 is true -33.3%\r\n//if total alerts i.e. Fired  > than 1 (alert) * resource total then flag3 is true -33.3%\r\n//100-flag1-flag2-flag3 = alert management score\r\n//totalresources\r\nresources \r\n| summarize resourcetotal=count()\r\n| project key=1, resourcetotal\r\n| join\r\n(alertsmanagementresources | where type =~ 'microsoft.alertsmanagement/alerts'\r\n| extend startDateTime=properties.essentials.startDateTime\r\n| where startDateTime > ago(30d)\r\n| extend State=tostring(properties.essentials.alertState)\r\n| extend monitorCondition=tostring(properties.essentials.monitorCondition)\r\n| summarize \r\n    TotalAlerts=count(), \r\n    New=countif(State==\"New\"), \r\n    Acknowledged=countif(State==\"Acknowledged\"), \r\n    Closed=countif(State==\"Closed\"), \r\n    Fired=countif(monitorCondition==\"Fired\"),\r\n    Resolved=countif(monitorCondition==\"Resolved\")\r\n| project TotalAlerts, New, Acknowledged, Closed, Fired, Resolved, pctClosed=toint((toreal(Closed)/toreal(Fired))*100), pctAck=toint((toreal(Acknowledged)/toreal(Fired))*100), key=1) on key\r\n| project \r\n    resourcetotal, TotalAlerts, New, Acknowledged, Closed, Fired, Resolved, pctClosed, pctAck,\r\n    Flag1=toreal(iff(pctClosed < 20, -33.3, 0.0)), Flag2=toreal(iff(pctAck < 50, -33.3, 0.0)), Flag3=toreal(iff(Fired > resourcetotal, -33.3, 0.0)) \r\n| project MonMgmtScore=100+toint(Flag1+Flag2+Flag3), resourcetotal, TotalAlerts, New, Acknowledged, Closed, Fired, Resolved, pctClosed, pctAck, Flag1, Flag2, Flag3\r\n| project key=1, Monitor=MonMgmtScore",
                  "size": 4,
                  "title": "Technology Management Score - Azure Monitor - merge",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "Flag1",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Flag2",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Flag3",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "MonMgmtScore",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "50ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      }
                    ]
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hidden"
                },
                "name": "monitorscorestep - merge",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| extend status = properties.status.code\r\n| project tostring(status)\r\n| summarize\r\n    TotalRecommendations=countif(status <> \"\"),\r\n    HealthyRecommendations=countif(status == \"Healthy\"),\r\n    UnhealthyRecommendations=countif(status == \"Unhealthy\"),\r\n    NotApplicableRecommendations=countif(status == \"NotApplicable\")\r\n| project \r\n    TotalRecommendations, HealthyRecommendations, UnhealthyRecommendations, NotApplicableRecommendations, \r\n    TotalMinNARecommendations=toreal(HealthyRecommendations)+toreal(UnhealthyRecommendations)\r\n| project \r\n    pctHealthy=toint((toreal(HealthyRecommendations)/toreal(TotalMinNARecommendations))*100), TotalRecommendations,\r\n    TotalMinNARecommendations, HealthyRecommendations, UnhealthyRecommendations, NotApplicableRecommendations\r\n| project key=1, DfC=pctHealthy",
                  "size": 4,
                  "title": "Technology Management Score - Defender for Cloud -merge",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "pctHealthy",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "40ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "TotalMinNARecommendations",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "45ch"
                        }
                      }
                    ]
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hidden"
                },
                "name": "dfcscorestep - merge",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "SecurityIncident\r\n| where CreatedTime {timerange:value}\r\n| summarize \r\n    Count=count(), \r\n    New=countif(Status==\"New\"), \r\n    Active=countif(Status==\"Active\"), \r\n    Closed=countif(Status==\"Closed\")\r\n| project Total=New+Active+Closed, New, Active, Closed, Good=Active+Closed\r\n| project \r\nTotal, New, Active, Closed, pctClosed=toint((toreal(Closed)/toreal(Total))*100), pctAct=toint((toreal(Active)/toreal(Total))*100), pctNew=toint((toreal(New)/toreal(Total))*100), pctGood=toint((toreal(Good)/toreal(Total))*100)\r\n| project \r\nTotal, New, Active, Closed, pctClosed, pctAct, pctNew, pctGood\r\n//Flag1=toreal(iff(pctClosed < 25, -33.3, 0.0)), Flag2=toreal(iff(pctAct < 25, -33.3, 0.0)), \r\n| project \r\npctGood, Total, New, Active, Closed\r\n| project key=1, Sentinel = pctGood",
                  "size": 4,
                  "title": "Technology Management Score - Microsoft Sentinel - merge",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "crossComponentResources": [
                    "{msworkspace}"
                  ],
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "pctGood",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "50ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "pctHealthy",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "40ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "TotalMinNARecommendations",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "45ch"
                        }
                      }
                    ]
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hidden"
                },
                "name": "sentmgmtscorestep - merge",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\"\r\n| extend state = tostring(properties.status.code)\r\n| extend cause = trim(\" \", tostring(properties.status.cause))\r\n//| summarize ResourcesCount = count() by tostring(state)\r\n| summarize \r\n    Total=count(), \r\n    Healthy=countif(tostring(state)==\"Healthy\"), \r\n    Unhealthy=countif(tostring(state)==\"Unhealthy\"), \r\n    NotApplicableOffByPolicy=countif(tostring(cause)==\"OffByPolicy\"),\r\n    NotApplicableVmNotReportingHB=countif(tostring(cause)==\"VmNotReportingHB\"),\r\n    NotApplicable=countif(tostring(state)==\"NotApplicable\")\r\n| project pctUMScore=toint(((toreal(Healthy)+toreal(NotApplicableOffByPolicy))/toreal(Total))*100), pctUnhealthy=toint((toreal(Unhealthy)/toreal(Total))*100), pctNotApplicable=toint((toreal(NotApplicable)/toreal(Total))*100), Total, Healthy, Unhealthy, NotApplicable, NotApplicableOffByPolicy, NotApplicableVmNotReportingHB\r\n| project key=1, pctUMScore",
                  "size": 4,
                  "title": "Update Management",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "visualization": "table",
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "pctUMScore",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "30ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "pctUnhealthy",
                        "formatter": 5,
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "pctNotApplicable",
                        "formatter": 5,
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "NotApplicableOffByPolicy",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "40ch"
                        }
                      },
                      {
                        "columnMatch": "NotApplicableVmNotReportingHB",
                        "formatter": 0,
                        "formatOptions": {
                          "customColumnWidthSetting": "40ch"
                        }
                      },
                      {
                        "columnMatch": "pctHealthy",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "30ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      }
                    ],
                    "labelSettings": [
                      {
                        "columnId": "pctUMScore",
                        "label": "Update Management Score"
                      }
                    ]
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hidden"
                },
                "name": "updatestep - merge",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "PolicyResources\r\n|â€¯whereâ€¯typeâ€¯==â€¯'microsoft.policyinsights/policystates'\r\n|â€¯extendâ€¯complianceStateâ€¯=â€¯tostring(properties.complianceState)\r\n//|â€¯summarizeâ€¯count()â€¯byâ€¯complianceState\r\n| summarize \r\n    TotalResources=count(), \r\n    Compliant=countif(complianceState==\"Compliant\"), \r\n    Noncompliant=countif(complianceState==\"NonCompliant\"), \r\n    Exempt=countif(complianceState==\"Exempt\")\r\n| project Compliant, Noncompliant, Exempt, pctCompliant=toint((toreal(Compliant)/(toreal(TotalResources)-toreal(Exempt)))*100), key=1\r\n| project \r\n    AzurePolicyManagementScore = pctCompliant, Compliant, Noncompliant, Exempt, key\r\n",
                  "size": 4,
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "AzurePolicyManagementScore",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "35ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 0
                          }
                        }
                      },
                      {
                        "columnMatch": "Compliant",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "success",
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "Noncompliant",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "3",
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "Exempt",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "stopped",
                              "text": "{0}{1}"
                            }
                          ]
                        }
                      },
                      {
                        "columnMatch": "key",
                        "formatter": 5
                      }
                    ],
                    "labelSettings": [
                      {
                        "columnId": "AzurePolicyManagementScore",
                        "label": "Azure Policy Management Score"
                      }
                    ]
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "hide",
                  "comparison": "isEqualTo",
                  "value": "hide"
                },
                "name": "pol - merge",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650636\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"advisorscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650656\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"backupscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650657\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"monitorscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650658\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"dfcscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650659\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"sentmgmtscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"ff51481a-21f4-490d-bcfc-62b46b986176\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"updatestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"d60a8db2-dc7c-45c0-8f27-575ebc598235\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"pol - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Total\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"Advisor\\\"]+[\\\"Backup\\\"]+[\\\"Monitor\\\"]+[\\\"DfC\\\"]+[\\\"Sentinel\\\"]+[\\\"Task\\\"]+[\\\"Update Management Score\\\"]+[\\\"Azure Policy\\\"])/8\"}}]},{\"originalName\":\"[advisorscorestep - merge].Advisor\",\"mergedName\":\"Advisor\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650636\"},{\"originalName\":\"[backupscorestep - merge].Backup\",\"mergedName\":\"Backup\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650656\"},{\"originalName\":\"[monitorscorestep - merge].Monitor\",\"mergedName\":\"Monitor\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650657\"},{\"originalName\":\"[dfcscorestep - merge].DfC\",\"mergedName\":\"DfC\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650658\"},{\"originalName\":\"[sentmgmtscorestep - merge].Sentinel\",\"mergedName\":\"Sentinel\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650659\"},{\"originalName\":\"[updatestep - merge].pctUMScore\",\"mergedName\":\"Update Management Score\",\"fromId\":\"ff51481a-21f4-490d-bcfc-62b46b986176\"},{\"originalName\":\"[taskscorerollupstep - merge].Task\",\"mergedName\":\"Task\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650636\"},{\"originalName\":\"[pol - merge].AzurePolicyManagementScore\",\"mergedName\":\"Azure Policy\",\"fromId\":\"d60a8db2-dc7c-45c0-8f27-575ebc598235\"},{\"originalName\":\"[taskscorerollupstep - merge].key\"},{\"originalName\":\"[advisorscorestep - merge].key\"},{\"originalName\":\"[backupscorestep - merge].key\"},{\"originalName\":\"[monitorscorestep - merge].key\"},{\"originalName\":\"[dfcscorestep - merge].key\"},{\"originalName\":\"[sentmgmtscorestep - merge].key\"},{\"originalName\":\"[updatestep - merge].key\"},{\"originalName\":\"[pol - merge].key\"},{\"originalName\":\"[pol - merge].Exempt\"},{\"originalName\":\"[pol - merge].Noncompliant\"},{\"originalName\":\"[pol - merge].Compliant\"}]}",
                  "size": 4,
                  "title": "Management Score",
                  "queryType": 7,
                  "visualization": "tiles",
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "Total",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 0
                          }
                        }
                      },
                      {
                        "columnMatch": "Advisor",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Backup",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Monitor",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "DfC",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Sentinel",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Update Management Score",
                        "formatter": 5
                      },
                      {
                        "columnMatch": "Task",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      }
                    ],
                    "labelSettings": [
                      {
                        "columnId": "Total",
                        "label": "Management Score",
                        "comment": "Management score total"
                      },
                      {
                        "columnId": "Advisor",
                        "label": "Azure Advisor"
                      },
                      {
                        "columnId": "Backup",
                        "label": "Azure Backup"
                      },
                      {
                        "columnId": "Monitor",
                        "label": "Azure Monitor"
                      },
                      {
                        "columnId": "DfC",
                        "label": "Defender for Cloud"
                      },
                      {
                        "columnId": "Sentinel",
                        "label": "Microsoft Sentinel"
                      },
                      {
                        "columnId": "Task",
                        "label": "Tasks"
                      }
                    ]
                  },
                  "tileSettings": {
                    "titleContent": {
                      "columnMatch": "Total",
                      "formatter": 4,
                      "formatOptions": {
                        "min": 0,
                        "max": 100,
                        "palette": "redGreen"
                      },
                      "numberFormat": {
                        "unit": 1,
                        "options": {
                          "style": "decimal",
                          "maximumFractionDigits": 0
                        }
                      }
                    },
                    "showBorder": false,
                    "size": "auto"
                  }
                },
                "customWidth": "20",
                "showPin": false,
                "name": "allmanagementscorestep - Copy"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650636\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"advisorscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650656\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"backupscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650657\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"monitorscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650658\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"dfcscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"f4222a4f-b784-4397-8a9b-f746d2650659\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"sentmgmtscorestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"ff51481a-21f4-490d-bcfc-62b46b986174\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"updatestep - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"},{\"id\":\"d60a8db2-dc7c-45c0-8f27-575ebc59823c\",\"mergeType\":\"innerunique\",\"leftTable\":\"taskscorerollupstep - merge\",\"rightTable\":\"pol - merge\",\"leftColumn\":\"key\",\"rightColumn\":\"key\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Total\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"Advisor\\\"]+[\\\"Backup\\\"]+[\\\"Monitor\\\"]+[\\\"DfC\\\"]+[\\\"Sentinel\\\"]+[\\\"Task\\\"])/6\"}}]},{\"originalName\":\"[advisorscorestep - merge].Advisor\",\"mergedName\":\"Advisor\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650636\"},{\"originalName\":\"[backupscorestep - merge].Backup\",\"mergedName\":\"Backup\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650656\"},{\"originalName\":\"[monitorscorestep - merge].Monitor\",\"mergedName\":\"Monitor\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650657\"},{\"originalName\":\"[pol - merge].AzurePolicyManagementScore\",\"mergedName\":\"Azure Policy\",\"fromId\":\"d60a8db2-dc7c-45c0-8f27-575ebc59823c\"},{\"originalName\":\"[updatestep - merge].pctUMScore\",\"mergedName\":\"Update Management Score\",\"fromId\":\"ff51481a-21f4-490d-bcfc-62b46b986174\"},{\"originalName\":\"[dfcscorestep - merge].DfC\",\"mergedName\":\"DfC\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650658\"},{\"originalName\":\"[sentmgmtscorestep - merge].Sentinel\",\"mergedName\":\"Sentinel\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650659\"},{\"originalName\":\"[taskscorerollupstep - merge].Task\",\"mergedName\":\"Task\",\"fromId\":\"f4222a4f-b784-4397-8a9b-f746d2650636\"},{\"originalName\":\"[taskscorerollupstep - merge].key\"},{\"originalName\":\"[advisorscorestep - merge].key\"},{\"originalName\":\"[backupscorestep - merge].key\"},{\"originalName\":\"[monitorscorestep - merge].key\"},{\"originalName\":\"[dfcscorestep - merge].key\"},{\"originalName\":\"[sentmgmtscorestep - merge].key\"},{\"originalName\":\"[updatestep - merge].key\"},{\"originalName\":\"[pol - merge].key\"},{\"originalName\":\"[pol - merge].Exempt\"},{\"originalName\":\"[pol - merge].Noncompliant\"},{\"originalName\":\"[pol - merge].Compliant\"}]}",
                  "size": 4,
                  "queryType": 7,
                  "gridSettings": {
                    "formatters": [
                      {
                        "columnMatch": "Total",
                        "formatter": 5,
                        "formatOptions": {
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 0
                          }
                        }
                      },
                      {
                        "columnMatch": "Advisor",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "redGreen",
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Backup",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "redGreen",
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Monitor",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "redGreen",
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Azure Policy",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "redGreen",
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Update Management Score",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "redGreen",
                          "customColumnWidthSetting": "30ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "DfC",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "redGreen",
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Sentinel",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "redGreen",
                          "customColumnWidthSetting": "25ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      {
                        "columnMatch": "Task",
                        "formatter": 4,
                        "formatOptions": {
                          "min": 0,
                          "max": 100,
                          "palette": "hotCold",
                          "customColumnWidthSetting": "30ch"
                        },
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      }
                    ],
                    "labelSettings": [
                      {
                        "columnId": "Total",
                        "label": "Management Score",
                        "comment": "Management score total"
                      },
                      {
                        "columnId": "Advisor",
                        "label": "Azure Advisor"
                      },
                      {
                        "columnId": "Backup",
                        "label": "Azure Backup"
                      },
                      {
                        "columnId": "Monitor",
                        "label": "Azure Monitor"
                      },
                      {
                        "columnId": "Update Management Score",
                        "label": "Azure Update Management"
                      },
                      {
                        "columnId": "DfC",
                        "label": "Defender for Cloud"
                      },
                      {
                        "columnId": "Sentinel",
                        "label": "Microsoft Sentinel"
                      },
                      {
                        "columnId": "Task",
                        "label": "Tasks"
                      }
                    ]
                  }
                },
                "customWidth": "80",
                "showPin": false,
                "name": "allmanagementscoresummarystep",
                "styleSettings": {
                  "showBorder": true
                }
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "Task Management Score - Breakdown",
                  "expandable": true,
                  "expanded": true,
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL | summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| extend technology_s=replace_string(technology_s, 'All Types', 'Foundation')\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| summarize \r\n    ManagementScore=toint((toreal(dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Closed\")))/toreal(count(systemAssignedId_s)))*100),\r\n    TotalTasks=count(systemAssignedId_s),\r\n    OpenTasks=dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Open\")),\r\n    ClosedTasks=dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Closed\"))\r\n\r\n",
                        "size": 3,
                        "title": "Rollup",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "ManagementScore",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold",
                                "customColumnWidthSetting": "50ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "TotalTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "OpenTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "ClosedTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Yes",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "No",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "200ch"
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "ManagementScore",
                              "label": "Task Management Score"
                            },
                            {
                              "columnId": "TotalTasks",
                              "label": "Total Tasks"
                            },
                            {
                              "columnId": "OpenTasks",
                              "label": "Open Tasks"
                            },
                            {
                              "columnId": "ClosedTasks",
                              "label": "Closed Tasks"
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "tags_s",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "name": "taskscorerollupstep",
                      "styleSettings": {
                        "margin": "2px",
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "CloudOpsv3_CL | summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| extend technology_s=replace_string(technology_s, 'All Types', 'Foundation')\r\n| summarize arg_max(TimeGenerated, *)  by systemAssignedId_s\r\n| summarize \r\n    ManagementScore=toint((toreal(dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Closed\")))/toreal(count(systemAssignedId_s)))*100),\r\n    TotalTasks=count(systemAssignedId_s),\r\n    OpenTasks=dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Open\")),\r\n    ClosedTasks=dcountif(systemAssignedId_s, (systemAssignedStatus_s == \"Closed\")) by technology_s\r\n| sort by technology_s asc\r\n\r\n",
                        "size": 3,
                        "title": "By technology",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{Workspace}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "ManagementScore",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold",
                                "customColumnWidthSetting": "50ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "TotalTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "OpenTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "ClosedTasks",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Yes",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "No",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "200ch"
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "technology_s",
                              "label": "Technology"
                            },
                            {
                              "columnId": "ManagementScore",
                              "label": "Management Score"
                            },
                            {
                              "columnId": "TotalTasks",
                              "label": "Total Tasks"
                            },
                            {
                              "columnId": "OpenTasks",
                              "label": "Open Tasks"
                            },
                            {
                              "columnId": "ClosedTasks",
                              "label": "Closed Tasks"
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "tags_s",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "name": "taskscorebreakdownstep",
                      "styleSettings": {
                        "margin": "2px",
                        "showBorder": true
                      }
                    }
                  ]
                },
                "name": "taskscoregrp"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "Technology Management Score - Breakdown",
                  "expandable": true,
                  "expanded": true,
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "//totalresources\r\nresources \r\n| summarize resourcetotal=count()\r\n| project key=1, resourcetotal\r\n| join\r\n//distinct resources with an advisor recommendation\r\n(advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| distinct tostring(properties.impactedValue)\r\n| summarize advisoraffectedresourcetotal=count()\r\n| project key=1, advisoraffectedresourcetotal) on key\r\n//what % resources of total resources do not have a recommendation? == the advisor management score\r\n| project pctnotaffected=toint(100-(toreal(advisoraffectedresourcetotal)/toreal(resourcetotal))*100), resourcetotal, advisoraffectedresourcetotal",
                        "size": 4,
                        "title": "Azure Advisor",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "pctnotaffected",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen",
                                "customColumnWidthSetting": "25ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "resourcetotal",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "advisoraffectedresourcetotal",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "ManagementScore",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold",
                                "customColumnWidthSetting": "50ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "TimeGenerated",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "TenantId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "SourceSystem",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "MG",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ManagementGroupName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Computer",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "RawData",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskSet_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateDefined_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "dateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "taskDue_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Yes",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "No",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": null,
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "systemAssignedStatus_s",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Open",
                                    "representation": "orange",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Retired",
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Recurring",
                                    "representation": "turquoise",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Not Applicable",
                                    "representation": "purple",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "blue",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "tags_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "task_s",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "200ch"
                              }
                            },
                            {
                              "columnMatch": "frequencyDays_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "daysSinceDateCompleted_s",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "referenceUrl1_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "referenceUrl2_s",
                              "formatter": 7
                            },
                            {
                              "columnMatch": "_ResourceId",
                              "formatter": 5
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "pctnotaffected",
                              "label": "Management Score"
                            },
                            {
                              "columnId": "resourcetotal",
                              "label": "Total"
                            },
                            {
                              "columnId": "advisoraffectedresourcetotal",
                              "label": "Active Recommendation"
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "tags_s",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            }
                          },
                          "showBorder": false,
                          "size": "auto"
                        }
                      },
                      "name": "advisorscorestep",
                      "styleSettings": {
                        "margin": "2px",
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources\r\n| where type in~ ('microsoft.compute/virtualmachines','microsoft.classiccompute/virtualmachines') \r\n| extend resourceId=tolower(id) \r\n| join kind = leftouter ( recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| project resourceId = tolower(tostring(properties.sourceResourceId)), backupItemid = id, isBackedUp = isnotempty(id) ) on resourceId \r\n| extend isProtected = isnotempty(backupItemid)\r\n| project id,name,resourceGroup,location,tags, tostring(isProtected)\r\n//| summarize count() by isProtected\r\n| summarize\r\n    VMTotal=toreal(count(id)),\r\n    Protected=toreal(dcountif(id, isProtected==\"True\")),\r\n    Unprotected=toreal(dcountif(id, isProtected==\"False\"))\r\n| project pctNotBackedUp=toint((Unprotected/VMTotal)*100), pctBackedUp=toint((Protected/VMTotal)*100), VMTotal, Protected, Unprotected",
                        "size": 4,
                        "title": "Azure Backup",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "pctNotBackedUp",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "pctBackedUp",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen",
                                "customColumnWidthSetting": "25ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "VMTotal",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Protected",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Unprotected",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "pctBackedUp",
                              "label": "Management Score"
                            },
                            {
                              "columnId": "VMTotal",
                              "label": "VM Total"
                            },
                            {
                              "columnId": "Protected",
                              "label": "Protected VMs"
                            },
                            {
                              "columnId": "Unprotected",
                              "label": "Unprotected VMs"
                            }
                          ]
                        }
                      },
                      "name": "backupscorestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "//if fired alerts <> 0, with less than 20% closed, then flag1 is true -33.3%\r\n//if fired alerts <> 0, with less than 50% acknowledged, then flag2 is true -33.3%\r\n//if total alerts i.e. Fired  > than 1 (alert) * resource total then flag3 is true -33.3%\r\n//100-flag1-flag2-flag3 = alert management score\r\n//totalresources\r\nresources \r\n| summarize resourcetotal=count()\r\n| project key=1, resourcetotal\r\n| join\r\n(alertsmanagementresources | where type =~ 'microsoft.alertsmanagement/alerts'\r\n| extend startDateTime=properties.essentials.startDateTime\r\n| where startDateTime > ago(30d)\r\n| extend State=tostring(properties.essentials.alertState)\r\n| extend monitorCondition=tostring(properties.essentials.monitorCondition)\r\n| summarize \r\n    TotalAlerts=count(), \r\n    New=countif(State==\"New\"), \r\n    Acknowledged=countif(State==\"Acknowledged\"), \r\n    Closed=countif(State==\"Closed\"), \r\n    Fired=countif(monitorCondition==\"Fired\"),\r\n    Resolved=countif(monitorCondition==\"Resolved\")\r\n| project TotalAlerts, New, Acknowledged, Closed, Fired, Resolved, pctClosed=toint((toreal(Closed)/toreal(Fired))*100), pctAck=toint((toreal(Acknowledged)/toreal(Fired))*100), key=1) on key\r\n| project \r\n    resourcetotal, TotalAlerts, New, Acknowledged, Closed, Fired, Resolved, pctClosed, pctAck,\r\n    Flag1=toreal(iff(pctClosed < 20, -33.3, 0.0)), Flag2=toreal(iff(pctAck < 50, -33.3, 0.0)), Flag3=toreal(iff(Fired > resourcetotal, -33.3, 0.0)) \r\n| project MonMgmtScore=100+toint(Flag1+Flag2+Flag3), resourcetotal, TotalAlerts, New, Acknowledged, Closed, Fired, Resolved, pctClosed, pctAck, Flag1, Flag2, Flag3",
                        "size": 4,
                        "title": "Azure Monitor",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "MonMgmtScore",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen",
                                "customColumnWidthSetting": "25ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "resourcetotal",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "TotalAlerts",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "New",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Acknowledged",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Closed",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Fired",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Fired",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Resolved",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Resolved",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "pctClosed",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "pctAck",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Flag1",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Flag2",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Flag3",
                              "formatter": 5
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "MonMgmtScore",
                              "label": "Management Score"
                            },
                            {
                              "columnId": "resourcetotal",
                              "label": "Resources"
                            },
                            {
                              "columnId": "TotalAlerts",
                              "label": "Alerts"
                            },
                            {
                              "columnId": "New",
                              "label": "New"
                            },
                            {
                              "columnId": "Acknowledged",
                              "label": "Acknowledged"
                            },
                            {
                              "columnId": "Closed",
                              "label": "Closed"
                            },
                            {
                              "columnId": "Fired",
                              "label": "Fired"
                            },
                            {
                              "columnId": "Resolved",
                              "label": "Resolved"
                            },
                            {
                              "columnId": "pctClosed",
                              "label": "Closed (%)"
                            },
                            {
                              "columnId": "pctAck",
                              "label": "Acknowledged (%)"
                            }
                          ]
                        }
                      },
                      "name": "monitorscorestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "PolicyResources\r\n|â€¯whereâ€¯typeâ€¯==â€¯'microsoft.policyinsights/policystates'\r\n|â€¯extendâ€¯complianceStateâ€¯=â€¯tostring(properties.complianceState)\r\n//|â€¯summarizeâ€¯count()â€¯byâ€¯complianceState\r\n| summarize \r\n    TotalResources=count(), \r\n    Compliant=countif(complianceState==\"Compliant\"), \r\n    Noncompliant=countif(complianceState==\"NonCompliant\"), \r\n    Exempt=countif(complianceState==\"Exempt\")\r\n| project Compliant, Noncompliant, Exempt, pctCompliant=toint((toreal(Compliant)/(toreal(TotalResources)-toreal(Exempt)))*100), key=1\r\n| project \r\n    AzurePolicyManagementScore = pctCompliant, Compliant, Noncompliant, Exempt, key\r\n",
                        "size": 4,
                        "title": "Azure Policy",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "AzurePolicyManagementScore",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen",
                                "customColumnWidthSetting": "25ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 0
                                }
                              }
                            },
                            {
                              "columnMatch": "Compliant",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Noncompliant",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Exempt",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "stopped",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "key",
                              "formatter": 5
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "AzurePolicyManagementScore",
                              "label": "Management Score"
                            }
                          ]
                        }
                      },
                      "name": "pol",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| extend status = properties.status.code\r\n| project tostring(status)\r\n| summarize\r\n    TotalRecommendations=countif(status <> \"\"),\r\n    HealthyRecommendations=countif(status == \"Healthy\"),\r\n    UnhealthyRecommendations=countif(status == \"Unhealthy\"),\r\n    NotApplicableRecommendations=countif(status == \"NotApplicable\")\r\n| project \r\n    TotalRecommendations, HealthyRecommendations, UnhealthyRecommendations, NotApplicableRecommendations, \r\n    TotalMinNARecommendations=toreal(HealthyRecommendations)+toreal(UnhealthyRecommendations)\r\n| project \r\n    pctHealthy=toint((toreal(HealthyRecommendations)/toreal(TotalMinNARecommendations))*100), TotalRecommendations,\r\n    TotalMinNARecommendations, HealthyRecommendations, UnhealthyRecommendations, NotApplicableRecommendations",
                        "size": 4,
                        "title": "Defender for Cloud",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "pctHealthy",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen",
                                "customColumnWidthSetting": "25ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "TotalRecommendations",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "TotalMinNARecommendations",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "HealthyRecommendations",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "UnhealthyRecommendations",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "NotApplicableRecommendations",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "stopped",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "pctHealthy",
                              "label": "Management Score"
                            },
                            {
                              "columnId": "TotalRecommendations",
                              "label": "Recommendations"
                            },
                            {
                              "columnId": "TotalMinNARecommendations",
                              "label": "Recommendations (excl. N/A)"
                            },
                            {
                              "columnId": "HealthyRecommendations",
                              "label": "Healthy"
                            },
                            {
                              "columnId": "UnhealthyRecommendations",
                              "label": "Unhealthy"
                            },
                            {
                              "columnId": "NotApplicableRecommendations",
                              "label": "Not Applicable"
                            }
                          ]
                        }
                      },
                      "name": "dfcscorestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "SecurityIncident\r\n| where CreatedTime {timerange:value}\r\n| summarize \r\n    Count=count(), \r\n    New=countif(Status==\"New\"), \r\n    Active=countif(Status==\"Active\"), \r\n    Closed=countif(Status==\"Closed\")\r\n| project Total=New+Active+Closed, New, Active, Closed, Good=Active+Closed\r\n| project \r\nTotal, New, Active, Closed, pctClosed=toint((toreal(Closed)/toreal(Total))*100), pctAct=toint((toreal(Active)/toreal(Total))*100), pctNew=toint((toreal(New)/toreal(Total))*100), pctGood=toint((toreal(Good)/toreal(Total))*100)\r\n| project \r\nTotal, New, Active, Closed, pctClosed, pctAct, pctNew, pctGood\r\n//Flag1=toreal(iff(pctClosed < 25, -33.3, 0.0)), Flag2=toreal(iff(pctAct < 25, -33.3, 0.0)), \r\n| project \r\npctGood, Total, New, Active, Closed",
                        "size": 4,
                        "title": "Microsoft Sentinel",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{msworkspace}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "pctGood",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen",
                                "customColumnWidthSetting": "25ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Total",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "New",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Active",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Alert",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Closed",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "pctHealthy",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold",
                                "customColumnWidthSetting": "40ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "TotalMinNARecommendations",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "45ch"
                              }
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "pctGood",
                              "label": "Management Score"
                            },
                            {
                              "columnId": "Total",
                              "label": "Total Incidents"
                            },
                            {
                              "columnId": "New",
                              "label": "New Incidents"
                            },
                            {
                              "columnId": "Active",
                              "label": "Active Incidents"
                            },
                            {
                              "columnId": "Closed",
                              "label": "Closed Incidents"
                            }
                          ]
                        }
                      },
                      "name": "sentmgmtscorestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\"\r\n| extend state = tostring(properties.status.code)\r\n| extend cause = trim(\" \", tostring(properties.status.cause))\r\n//| summarize ResourcesCount = count() by tostring(state)\r\n| summarize \r\n    Total=count(), \r\n    Healthy=countif(tostring(state)==\"Healthy\"), \r\n    Unhealthy=countif(tostring(state)==\"Unhealthy\"), \r\n    NotApplicableOffByPolicy=countif(tostring(cause)==\"OffByPolicy\"),\r\n    NotApplicableVmNotReportingHB=countif(tostring(cause)==\"VmNotReportingHB\"),\r\n    NotApplicable=countif(tostring(state)==\"NotApplicable\")\r\n| project pctUMScore=toint(((toreal(Healthy)+toreal(NotApplicableOffByPolicy))/toreal(Total))*100), pctUnhealthy=toint((toreal(Unhealthy)/toreal(Total))*100), pctNotApplicable=toint((toreal(NotApplicable)/toreal(Total))*100), Total, Healthy, Unhealthy, NotApplicable, NotApplicableOffByPolicy, NotApplicableVmNotReportingHB",
                        "size": 4,
                        "title": "Azure Update Management",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "pctUMScore",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "redGreen",
                                "customColumnWidthSetting": "25ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "pctUnhealthy",
                              "formatter": 5,
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "pctNotApplicable",
                              "formatter": 5,
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Total",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "1",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Healthy",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Unhealthy",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "NotApplicable",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "stopped",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "NotApplicableOffByPolicy",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "NotApplicableVmNotReportingHB",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "pctHealthy",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold",
                                "customColumnWidthSetting": "30ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "pctUMScore",
                              "label": "Management Score"
                            },
                            {
                              "columnId": "pctUnhealthy",
                              "label": "Unhealthy Score"
                            },
                            {
                              "columnId": "pctNotApplicable",
                              "label": "Not Applicable Score"
                            },
                            {
                              "columnId": "Total",
                              "label": "Resources"
                            },
                            {
                              "columnId": "Healthy",
                              "label": "Healthy"
                            },
                            {
                              "columnId": "Unhealthy",
                              "label": "Unhealthy"
                            },
                            {
                              "columnId": "NotApplicable",
                              "label": "All N/A Resources",
                              "comment": ""
                            },
                            {
                              "columnId": "NotApplicableOffByPolicy",
                              "label": "N/A - Off By Policy"
                            },
                            {
                              "columnId": "NotApplicableVmNotReportingHB",
                              "label": "N/A - No Heartbeat"
                            }
                          ]
                        }
                      },
                      "name": "updatestep",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "name": "techscoregrp"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "selectedTab",
            "comparison": "isEqualTo",
            "value": "Management Score"
          },
          "name": "managementscoregrp"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "The number of active recommendations, alerts, incidents, missing updates, unprotected entities, the compliance state and secure score are used to get an indication of the management that is performed in the environment."
                },
                "name": "int"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "parameters": [
                    {
                      "id": "5862a24c-8aed-49c0-b4e9-6bca33ba93e9",
                      "version": "KqlParameterItem/1.0",
                      "name": "selectedTab",
                      "label": "Select a technology",
                      "type": 10,
                      "isRequired": true,
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "jsonData": "[[\r\n { \"value\": \"Azure Advisor\", \"label\": \"Azure Advisor\", \"selected\":true },\r\n {\"value\": \"Azure Backup\", \"label\": \"Azure Backup\"},\r\n {\"value\": \"Azure Monitor\", \"label\": \"Azure Monitor\"},\r\n {\"value\": \"Azure Policy\", \"label\": \"Azure Policy\"},\r\n {\"value\": \"Azure Site Recovery\", \"label\": \"Azure Site Recovery\"},\r\n {\"value\": \"Azure Update Management\", \"label\": \"Azure Update Management\"},\r\n {\"value\": \"Defender for Cloud\", \"label\": \"Defender for Cloud\"},\r\n {\"value\": \"Microsoft Sentinel\", \"label\": \"Microsoft Sentinel\"}\r\n]",
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "value": "Azure Policy"
                    }
                  ],
                  "style": "formVertical",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                "name": "parameters - 4"
              },
              {
                "type": 1,
                "content": {
                  "json": "## {selectedTab}"
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isNotEqualTo"
                },
                "name": "tab"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "490ed8af-bdcb-46bd-86d1-588f11d20ba3",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Expert/AdvisorMenuBlade/~/score",
                            "linkTarget": "Url",
                            "linkLabel": "Advisor Score",
                            "style": "link"
                          },
                          {
                            "id": "7379e170-d88a-4f4c-9493-b8e0ac44854f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Expert/AdvisorMenuBlade/~/cost",
                            "linkTarget": "Url",
                            "linkLabel": "Cost Recommendations",
                            "style": "link"
                          },
                          {
                            "id": "a5686133-27b3-4cb3-bd92-d5e992ec6334",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Expert/AdvisorMenuBlade/~/security",
                            "linkTarget": "Url",
                            "linkLabel": "Security Recommendations",
                            "style": "link"
                          },
                          {
                            "id": "4e0e5045-98f0-48d3-a174-157025080354",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Expert/AdvisorMenuBlade/~/highavailability",
                            "linkTarget": "Url",
                            "linkLabel": "Reliability Recommendations",
                            "style": "link"
                          },
                          {
                            "id": "e08fbb6b-804f-409e-b6a9-e6515d2c22dc",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Expert/AdvisorMenuBlade/~/OperationalExcellence",
                            "linkTarget": "Url",
                            "linkLabel": "Operational Excellence Recommendations",
                            "style": "link"
                          },
                          {
                            "id": "8277f7ed-fd59-4e37-b7c6-15da18e4e4c1",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Expert/AdvisorMenuBlade/~/Performance",
                            "linkTarget": "Url",
                            "linkLabel": "Performance Recommendations",
                            "style": "link"
                          },
                          {
                            "id": "fd592027-e631-46bb-ba42-f42291653d2f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Expert/AdvisorMenuBlade/~/alerts",
                            "linkTarget": "Url",
                            "linkLabel": "Advisor Alerts",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 5"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| distinct tostring(properties.shortDescription.problem)\r\n| summarize count()",
                        "size": 4,
                        "title": "All Recommendations",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "tiles",
                        "tileSettings": {
                          "titleContent": {
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "customWidth": "15",
                      "name": "recstep2 - Copy"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| extend Category = tostring(properties.category)\r\n| extend Category = replace('HighAvailability', 'Reliability', Category)\r\n| extend Description = tostring(properties.shortDescription.problem)\r\n| extend ImpactedField = tostring(properties.impactedField)\r\n| extend ImpactedValue = tostring(properties.impactedValue)\r\n| extend Impact = tostring(properties.impact)\r\n| extend LastUpdated = tostring(properties.lastUpdated)\r\n| project Impact, ImpactedField, ImpactedValue, Description, resourceGroup, subscriptionId, Category, LastUpdated\r\n| summarize Count = count() by Category",
                        "size": 4,
                        "title": "Category (by affected resource)",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "tiles",
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Category",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "Count",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "coldHot"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "customWidth": "50",
                      "name": "recstep"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| extend Category = tostring(properties.category)\r\n| extend Category = replace('HighAvailability', 'Reliability', Category)\r\n| extend Description = tostring(properties.shortDescription.problem)\r\n| extend ImpactedField = tostring(properties.impactedField)\r\n| extend ImpactedValue = tostring(properties.impactedValue)\r\n| extend Impact = tostring(properties.impact)\r\n| extend LastUpdated = tostring(properties.lastUpdated)\r\n| project Impact, ImpactedField, ImpactedValue, Description, resourceGroup, subscriptionId, Category, LastUpdated\r\n| summarize Count = count() by Impact",
                        "size": 4,
                        "title": "Impact Level (by affected resource)",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "tiles",
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Impact",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "contains",
                                  "thresholdValue": "High",
                                  "representation": "Sev0",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Medium",
                                  "representation": "Sev1",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Low",
                                  "representation": "Sev2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "success",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          "leftContent": {
                            "columnMatch": "Count",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "none"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "customWidth": "30",
                      "name": "recstep2"
                    },
                    {
                      "type": 9,
                      "content": {
                        "version": "KqlParameterItem/1.0",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "parameters": [
                          {
                            "id": "a1620133-df2d-4aa7-bb75-d1b4845d6f86",
                            "version": "KqlParameterItem/1.0",
                            "name": "impactlevel",
                            "label": "Impact Level",
                            "type": 2,
                            "isRequired": true,
                            "multiSelect": true,
                            "quote": "'",
                            "delimiter": ",",
                            "query": "advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| distinct tostring(properties.impact)",
                            "crossComponentResources": [
                              "{Subscription}"
                            ],
                            "typeSettings": {
                              "additionalResourceOptions": [
                                "value::all"
                              ],
                              "showDefault": false
                            },
                            "timeContext": {
                              "durationMs": 86400000
                            },
                            "defaultValue": "value::all",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "value": [
                              "value::all"
                            ]
                          }
                        ],
                        "style": "pills",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources"
                      },
                      "name": "parameters - 4"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "advisorresources\r\n| where type == 'microsoft.advisor/recommendations'\r\n| extend Category = tostring(properties.category)\r\n| extend Category = replace('HighAvailability', 'Reliability', Category)\r\n| extend Description = tostring(properties.shortDescription.problem)\r\n| extend ImpactedField = tostring(properties.impactedField)\r\n| extend ImpactedValue = tostring(properties.impactedValue)\r\n| extend Impact = tostring(properties.impact)\r\n| extend LastUpdated = tostring(properties.lastUpdated)\r\n| where Impact in ({impactlevel})\r\n| project Impact, Description, subscriptionId, Category, ImpactedField, ImpactedValue, resourceGroup, LastUpdated\r\n| sort by Impact asc",
                        "size": 0,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 15,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true,
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "Impact",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Description",
                              "formatter": 0,
                              "formatOptions": {
                                "customColumnWidthSetting": "80ch"
                              }
                            },
                            {
                              "columnMatch": "subscriptionId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "Category",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "ImpactedField",
                              "formatter": 16,
                              "formatOptions": {
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "ImpactedValue",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": "Resource",
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "LastUpdated",
                              "formatter": 6
                            }
                          ],
                          "rowLimit": 500,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "subscriptionId"
                            ],
                            "expandTopLevel": false,
                            "finalBy": "Category"
                          },
                          "labelSettings": [
                            {
                              "columnId": "subscriptionId",
                              "label": "Subscription"
                            },
                            {
                              "columnId": "ImpactedField",
                              "label": "Type"
                            },
                            {
                              "columnId": "ImpactedValue",
                              "label": "Resource"
                            },
                            {
                              "columnId": "resourceGroup",
                              "label": "Resource Group"
                            },
                            {
                              "columnId": "LastUpdated",
                              "label": "Last Updated"
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Category",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "Count",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "coldHot"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "name": "recstep - Copy",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Azure Advisor"
                },
                "name": "aa"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "490ed8af-bdcb-46bd-86d1-588f11d20ba3",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/alertsV2",
                            "linkTarget": "Url",
                            "linkLabel": "Alerts",
                            "style": "link"
                          },
                          {
                            "id": "7379e170-d88a-4f4c-9493-b8e0ac44854f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Health/AzureHealthBrowseBlade/~/serviceIssues",
                            "linkTarget": "Url",
                            "linkLabel": "Service Health",
                            "style": "link"
                          },
                          {
                            "id": "a5686133-27b3-4cb3-bd92-d5e992ec6334",
                            "cellValue": "https://portal.azure.com/#blade/AppInsightsExtension/UsageNotebookBlade/ComponentId/Azure%20Monitor/ConfigurationId/community-Workbooks%2FLogAnalytics%20Workspace%2FAtScale/Type/workbook/WorkbookTemplateName/Log%20Analytics%20Workspace%20Insights",
                            "linkTarget": "Url",
                            "linkLabel": "Log Analytics Workspace Insights",
                            "style": "link"
                          },
                          {
                            "id": "4e0e5045-98f0-48d3-a174-157025080354",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/activityLog",
                            "linkTarget": "Url",
                            "linkLabel": "Activity Log",
                            "style": "link"
                          },
                          {
                            "id": "e08fbb6b-804f-409e-b6a9-e6515d2c22dc",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/metrics",
                            "linkTarget": "Url",
                            "linkLabel": "Metrics",
                            "style": "link"
                          },
                          {
                            "id": "8277f7ed-fd59-4e37-b7c6-15da18e4e4c1",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/logs",
                            "linkTarget": "Url",
                            "linkLabel": "Logs",
                            "style": "link"
                          },
                          {
                            "id": "fd592027-e631-46bb-ba42-f42291653d2f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/applicationsInsights",
                            "linkTarget": "Url",
                            "linkLabel": "Application Insights",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 5"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources\r\n| where type in ('microsoft.operationalinsights/workspaces',\r\n 'microsoft.insights/actiongroups',\r\n 'microsoft.alertsmanagement/actionrules',\r\n 'microsoft.alertsmanagement/smartdetectoralertrules',\r\n 'microsoft.insights/activitylogalerts',\r\n 'microsoft.insights/metricalerts',\r\n 'microsoft.insights/autoscalesettings',\r\n 'microsoft.insights/components',\r\n 'microsoft.insights/datacollectionrules',\r\n 'microsoft.insights/datacollectionendpoints',\r\n 'microsoft.insights/privatelinkscopes',\r\n 'microsoft.insights/scheduledqueryrules',\r\n 'microsoft.operationalinsights/querypacks',\r\n 'microsoft.insights/webtests',\r\n 'microsoft.insights/workbooks')\r\n| summarize count() by type",
                        "size": 3,
                        "title": "Azure Monitor Resources",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "tiles",
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "type",
                            "formatter": 16,
                            "formatOptions": {
                              "showIcon": true
                            }
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "coldHot"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "name": "recstep"
                    },
                    {
                      "type": 9,
                      "content": {
                        "version": "KqlParameterItem/1.0",
                        "parameters": [
                          {
                            "id": "a1620133-df2d-4aa7-bb75-d1b4845d6f86",
                            "version": "KqlParameterItem/1.0",
                            "name": "sev",
                            "label": "Severity",
                            "type": 2,
                            "isRequired": true,
                            "multiSelect": true,
                            "quote": "'",
                            "delimiter": ",",
                            "query": "AlertsManagementResources | where type =~ 'microsoft.alertsmanagement/alerts'\r\n| where todatetime(properties.essentials.startDateTime) > ago(30d)\r\n| extend severity=tostring(properties.essentials.severity)\r\n| distinct severity",
                            "crossComponentResources": [
                              "{Subscription}"
                            ],
                            "value": [
                              "value::all"
                            ],
                            "typeSettings": {
                              "additionalResourceOptions": [
                                "value::all"
                              ],
                              "showDefault": false
                            },
                            "timeContext": {
                              "durationMs": 86400000
                            },
                            "defaultValue": "value::all",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources"
                          },
                          {
                            "id": "e536f8bf-b488-411a-8e5d-bd6165ec071f",
                            "version": "KqlParameterItem/1.0",
                            "name": "timerange",
                            "label": "Time Range",
                            "type": 4,
                            "isRequired": true,
                            "value": {
                              "durationMs": 604800000
                            },
                            "typeSettings": {
                              "selectableValues": [
                                {
                                  "durationMs": 86400000
                                },
                                {
                                  "durationMs": 604800000
                                },
                                {
                                  "durationMs": 1209600000
                                },
                                {
                                  "durationMs": 2592000000
                                }
                              ]
                            },
                            "timeContext": {
                              "durationMs": 86400000
                            }
                          }
                        ],
                        "style": "pills",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      "name": "parameters - 4"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "AlertsManagementResources | where type =~ 'microsoft.alertsmanagement/alerts'\r\n| where todatetime(properties.essentials.startDateTime) {timerange:value}\r\n| extend state=tostring(properties.essentials.alertState)\r\n| extend severity=tostring(properties.essentials.severity)\r\n| extend monitorCondition=tostring(properties.essentials.monitorCondition)\r\n| extend targetResource=tostring(properties.essentials.targetResource)\r\n| extend description=tostring(properties.essentials.description)\r\n| extend startDateTime=tostring(properties.essentials.startDateTime)\r\n| extend monitorConditionResolvedDateTime=tostring(properties.essentials.monitorConditionResolvedDateTime)\r\n| project subscriptionId, id, name, state, severity, resourceGroup, monitorCondition, targetResource, startDateTime, monitorConditionResolvedDateTime, description\r\n| where severity in ({sev})",
                        "size": 0,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 15,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true,
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "subscriptionId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "id",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "name",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "state",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "New",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Acknowledged",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "severity",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev0",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev1",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev2",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev3",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev4",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "resourceGroup",
                              "formatter": 14,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": false
                              }
                            },
                            {
                              "columnMatch": "monitorCondition",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Fired",
                                    "representation": "2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Resolved",
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "startDateTime",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "monitorConditionResolvedDateTime",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "type",
                              "formatter": 16,
                              "formatOptions": {
                                "showIcon": true
                              }
                            }
                          ],
                          "rowLimit": 500,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "subscriptionId"
                            ],
                            "expandTopLevel": false,
                            "finalBy": "name"
                          },
                          "labelSettings": [
                            {
                              "columnId": "subscriptionId",
                              "label": "Subscription"
                            },
                            {
                              "columnId": "name",
                              "label": "Alert Name"
                            },
                            {
                              "columnId": "state",
                              "label": "Alert State"
                            },
                            {
                              "columnId": "severity",
                              "label": "Severity"
                            },
                            {
                              "columnId": "resourceGroup",
                              "label": "Resource Group"
                            },
                            {
                              "columnId": "monitorCondition",
                              "label": "Monitor Condition"
                            },
                            {
                              "columnId": "targetResource",
                              "label": "Resource"
                            },
                            {
                              "columnId": "startDateTime",
                              "label": "Start Time"
                            },
                            {
                              "columnId": "monitorConditionResolvedDateTime",
                              "label": "Resolved Time"
                            },
                            {
                              "columnId": "description",
                              "label": "Description"
                            }
                          ]
                        }
                      },
                      "name": "query - 5",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "AlertsManagementResources | where type =~ 'microsoft.alertsmanagement/alerts'\r\n| where todatetime(properties.essentials.startDateTime) {timerange:value}\r\n| extend State=tostring(properties.essentials.alertState)\r\n| extend monitorCondition=tostring(properties.essentials.monitorCondition)\r\n| summarize Count=count(), New=countif(State==\"New\"), \r\nAcknowledged=countif(State==\"Acknowledged\"), \r\nClosed=countif(State==\"Closed\"), \r\nFired=countif(monitorCondition==\"Fired\"),\r\nResolved=countif(monitorCondition==\"Resolved\")\r\nby Severity=tostring(properties.essentials.severity)\r\n| order by Severity asc\r\n| project Severity, New, Acknowledged, Closed, Fired, Resolved\r\n| where Severity in ({sev})",
                        "size": 3,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Severity",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev0",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev1",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev2",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev3",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Sev4",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "New",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "redBright"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Acknowledged",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "yellow"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Closed",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "green"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Fired",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "redBright"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Resolved",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "green"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "Severity",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Sev0",
                                  "representation": "Sev0",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Sev1",
                                  "representation": "Sev1",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Sev2",
                                  "representation": "Sev2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Sev3",
                                  "representation": "Sev3",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Sev4",
                                  "representation": "Sev4",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "more",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          "leftContent": {
                            "columnMatch": "Count",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "none"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "name": "recstep2 - Copy - Copy",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Azure Monitor"
                },
                "name": "am"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "490ed8af-bdcb-46bd-86d1-588f11d20ba3",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Policy/PolicyMenuBlade/~/Overview",
                            "linkTarget": "Url",
                            "linkLabel": "Overview",
                            "style": "link"
                          },
                          {
                            "id": "7379e170-d88a-4f4c-9493-b8e0ac44854f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Policy/PolicyMenuBlade/~/Compliance",
                            "linkTarget": "Url",
                            "linkLabel": "Compliance",
                            "style": "link"
                          },
                          {
                            "id": "a5686133-27b3-4cb3-bd92-d5e992ec6334",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Policy/PolicyMenuBlade/~/Remediation",
                            "linkTarget": "Url",
                            "linkLabel": "Remediation",
                            "style": "link"
                          },
                          {
                            "id": "4e0e5045-98f0-48d3-a174-157025080354",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Policy/PolicyMenuBlade/~/Exemptions",
                            "linkTarget": "Url",
                            "linkLabel": "Exemptions",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 5"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "PolicyResources\r\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\r\n| extend complianceState = tostring(properties.complianceState)\r\n| extend\r\n\tresourceId = tostring(properties.resourceId),\r\n\tpolicyAssignmentId = tostring(properties.policyAssignmentId),\r\n\tpolicyAssignmentScope = tostring(properties.policyAssignmentScope),\r\n\tpolicyAssignmentName = tostring(properties.policyAssignmentName),\r\n\tpolicyDefinitionId = tostring(properties.policyDefinitionId),\r\n\tpolicyDefinitionReferenceId = tostring(properties.policyDefinitionReferenceId),\r\n\tstateWeight = iff(complianceState == 'NonCompliant', int(300), iff(complianceState == 'Compliant', int(200), iff(complianceState == 'Conflict', int(100), iff(complianceState == 'Exempt', int(50), int(0)))))\r\n| summarize max(stateWeight) by resourceId, policyAssignmentId, policyAssignmentScope, policyAssignmentName\r\n| summarize counts = count() by policyAssignmentId, policyAssignmentScope, max_stateWeight, policyAssignmentName\r\n| summarize overallStateWeight = max(max_stateWeight),\r\nnonCompliantCount = sumif(counts, max_stateWeight == 300),\r\ncompliantCount = sumif(counts, max_stateWeight == 200),\r\nconflictCount = sumif(counts, max_stateWeight == 100),\r\nexemptCount = sumif(counts, max_stateWeight == 50) by policyAssignmentId, policyAssignmentScope, policyAssignmentName\r\n| extend totalResources = todouble(nonCompliantCount + compliantCount + conflictCount + exemptCount)\r\n| extend compliancePercentage = iff(totalResources == 0, todouble(100), 100 * todouble(compliantCount + exemptCount) / totalResources)\r\n| project policyAssignmentName, scope = policyAssignmentScope,\r\ncomplianceState = iff(overallStateWeight == 300, 'noncompliant', iff(overallStateWeight == 200, 'compliant', iff(overallStateWeight == 100, 'conflict', iff(overallStateWeight == 50, 'exempt', 'notstarted')))),\r\ncompliancePercentage,\r\ncompliantCount,\r\nnonCompliantCount,\r\nconflictCount,\r\nexemptCount\r\n| order by scope desc",
                        "size": 2,
                        "title": "Compliance by policy assignment",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "policyAssignmentName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "scope",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "complianceState",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "==",
                                    "thresholdValue": "compliant",
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "==",
                                    "thresholdValue": "noncompliant",
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "compliancePercentage",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 0
                                }
                              }
                            },
                            {
                              "columnMatch": "exemptCount",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            }
                          ],
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "scope"
                            ],
                            "expandTopLevel": true,
                            "finalBy": "policyAssignmentName"
                          },
                          "labelSettings": [
                            {
                              "columnId": "policyAssignmentName",
                              "label": "Policy Assignment Name"
                            },
                            {
                              "columnId": "scope",
                              "label": "Scope"
                            },
                            {
                              "columnId": "complianceState",
                              "label": "State"
                            },
                            {
                              "columnId": "compliancePercentage",
                              "label": "Compliance"
                            },
                            {
                              "columnId": "compliantCount",
                              "label": "Compliant"
                            },
                            {
                              "columnId": "nonCompliantCount",
                              "label": "Noncompliant"
                            },
                            {
                              "columnId": "conflictCount",
                              "label": "Conflict"
                            },
                            {
                              "columnId": "exemptCount",
                              "label": "Exempt"
                            }
                          ]
                        }
                      },
                      "customWidth": "50",
                      "name": "compliance",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "PolicyResources\r\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\r\n| extend complianceState = tostring(properties.complianceState)\r\n| extend\r\n\tresourceId = tostring(properties.resourceId),\r\n\tresourceType = tolower(tostring(properties.resourceType)),\r\n\tpolicyAssignmentId = tostring(properties.policyAssignmentId),\r\n\tpolicyDefinitionId = tostring(properties.policyDefinitionId),\r\n\tpolicyDefinitionReferenceId = tostring(properties.policyDefinitionReferenceId),\r\n\tstateWeight = iff(complianceState == 'NonCompliant', int(300), iff(complianceState == 'Compliant', int(200), iff(complianceState == 'Conflict', int(100), iff(complianceState == 'Exempt', int(50), int(0)))))\r\n| summarize max(stateWeight) by resourceId, resourceType\r\n| summarize counts = count() by resourceType, max_stateWeight\r\n| summarize overallStateWeight = max(max_stateWeight),\r\nnonCompliantCount = sumif(counts, max_stateWeight == 300),\r\ncompliantCount = sumif(counts, max_stateWeight == 200),\r\nconflictCount = sumif(counts, max_stateWeight == 100),\r\nexemptCount = sumif(counts, max_stateWeight == 50) by resourceType\r\n| extend totalResources = todouble(nonCompliantCount + compliantCount + conflictCount + exemptCount)\r\n| extend compliancePercentage = iff(totalResources == 0, todouble(100), 100 * todouble(compliantCount + exemptCount) / totalResources)\r\n| project resourceType,\r\noverAllComplianceState = iff(overallStateWeight == 300, 'noncompliant', iff(overallStateWeight == 200, 'compliant', iff(overallStateWeight == 100, 'conflict', iff(overallStateWeight == 50, 'exempt', 'notstarted')))),\r\ncompliancePercentage,\r\ncompliantCount,\r\nnonCompliantCount,\r\nconflictCount,\r\nexemptCount\r\n| order by resourceType desc",
                        "size": 2,
                        "title": "Compliance by resource type",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "resourceType",
                              "formatter": 16,
                              "formatOptions": {
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "overAllComplianceState",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "==",
                                    "thresholdValue": "compliant",
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "==",
                                    "thresholdValue": "noncompliant",
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "compliancePercentage",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 0
                                }
                              }
                            },
                            {
                              "columnMatch": "exemptCount",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "resourceType",
                              "label": "Type"
                            },
                            {
                              "columnId": "overAllComplianceState",
                              "label": "OverAll Compliance"
                            },
                            {
                              "columnId": "compliancePercentage",
                              "label": "Compliance"
                            },
                            {
                              "columnId": "compliantCount",
                              "label": "Compliant"
                            },
                            {
                              "columnId": "nonCompliantCount",
                              "label": "Noncompliant"
                            },
                            {
                              "columnId": "conflictCount",
                              "label": "Conflict"
                            },
                            {
                              "columnId": "exemptCount",
                              "label": "Exempt"
                            }
                          ]
                        }
                      },
                      "customWidth": "50",
                      "name": "rscc",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Azure Policy"
                },
                "name": "ap"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "5ac541ef-0206-47fd-84be-6134b685bdf3",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/~/overview",
                            "linkTarget": "Url",
                            "linkLabel": "Backup Center",
                            "style": "link"
                          },
                          {
                            "id": "b4cfce6b-a1c4-4ce6-b2c3-7173074583e9",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/~/BackupCompliance",
                            "linkTarget": "Url",
                            "linkLabel": "Backup Compliance",
                            "style": "link"
                          },
                          {
                            "id": "b1e5c3b1-f569-40d5-afa8-fbcefc26815f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/~/policyAndCompliance",
                            "linkTarget": "Url",
                            "linkLabel": "Backup Policies",
                            "style": "link"
                          },
                          {
                            "id": "f3c41b6f-07c8-4440-9380-b841863e7a45",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/~/ProtectableDataSources",
                            "linkTarget": "Url",
                            "linkLabel": "Protectable Datasources",
                            "style": "link"
                          },
                          {
                            "id": "a04dc36a-ab28-4270-b0e9-fd3bcf96f96f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/~/backupReportsConfigure",
                            "linkTarget": "Url",
                            "linkLabel": "Backup Reports",
                            "style": "link"
                          },
                          {
                            "id": "c52bd675-dc3a-4197-9c01-70c3a5e244ab",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/~/Vaults",
                            "linkTarget": "Url",
                            "linkLabel": "Backup and Recovery Services Vaults",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 1"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources\r\n| where type in ('microsoft.recoveryservices/vaults')\r\n| summarize count() by type",
                        "size": 4,
                        "title": "Azure Backup Resources",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "tiles",
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "type",
                            "formatter": 16,
                            "formatOptions": {
                              "showIcon": true
                            }
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "name": "query - 0"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "Resources\r\n| where type in~ ('microsoft.compute/virtualmachines','microsoft.classiccompute/virtualmachines') \r\n| extend resourceId=tolower(id) \r\n| join kind = leftouter ( RecoveryServicesResources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| project resourceId = tolower(tostring(properties.sourceResourceId)), backupItemid = id, isBackedUp = isnotempty(id) ) on resourceId \r\n| extend isProtected = isnotempty(backupItemid)\r\n| project id,name,resourceGroup,location,tags, tostring(isProtected)\r\n| extend isProtected = replace(\"False\", \"Unprotected\", isProtected)\r\n| extend isProtected = replace(\"True\", \"Protected\", isProtected)\r\n| summarize count() by isProtected",
                        "size": 4,
                        "title": "Virtual Machine Protection",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "tiles",
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "isProtected",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Protected",
                                  "representation": "success",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Unprotected",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "more",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "none"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "customWidth": "25",
                      "name": "query - 2",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources\r\n| where type in~ ('microsoft.compute/virtualmachines','microsoft.classiccompute/virtualmachines') \r\n| extend resourceId=tolower(id) \r\n| join kind = leftouter ( recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where properties.backupManagementType == \"AzureIaasVM\"\r\n| project subscriptionId, resourceId = tolower(tostring(properties.sourceResourceId)), backupItemid = id, isBackedUp = isnotempty(id) ) on resourceId \r\n| extend isProtected = isnotempty(backupItemid)\r\n| project tostring(isProtected), subscriptionId,id,name,resourceGroup,location,tags",
                        "size": 0,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 15,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true,
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "isProtected",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "True",
                                    "representation": "success",
                                    "text": "{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "False",
                                    "representation": "more",
                                    "text": "{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "subscriptionId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "id",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": "Resource",
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "name",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "resourceGroup",
                              "formatter": 14,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "location",
                              "formatter": 5
                            }
                          ],
                          "rowLimit": 500,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "subscriptionId"
                            ],
                            "expandTopLevel": false,
                            "finalBy": "location"
                          },
                          "labelSettings": [
                            {
                              "columnId": "isProtected",
                              "label": "Protected"
                            },
                            {
                              "columnId": "subscriptionId",
                              "label": "Subscription"
                            },
                            {
                              "columnId": "id",
                              "label": "Resource"
                            },
                            {
                              "columnId": "resourceGroup",
                              "label": "Resource Group"
                            },
                            {
                              "columnId": "location",
                              "label": "Location"
                            },
                            {
                              "columnId": "tags",
                              "label": "Tags"
                            }
                          ]
                        },
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "isProtected",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Protected VMs",
                                  "representation": "success",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "contains",
                                  "thresholdValue": "Unprotected VMs",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "more",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "none"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "customWidth": "75",
                      "name": "bupd",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Azure Backup"
                },
                "name": "ab"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "5ac541ef-0206-47fd-84be-6134b685bdf3",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/23",
                            "linkTarget": "Url",
                            "linkLabel": "Security Posture",
                            "style": "link"
                          },
                          {
                            "id": "b4cfce6b-a1c4-4ce6-b2c3-7173074583e9",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/22",
                            "linkTarget": "Url",
                            "linkLabel": "Regulatory Compliance",
                            "style": "link"
                          },
                          {
                            "id": "b1e5c3b1-f569-40d5-afa8-fbcefc26815f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/25",
                            "linkTarget": "Url",
                            "linkLabel": "Inventory",
                            "style": "link"
                          },
                          {
                            "id": "f3c41b6f-07c8-4440-9380-b841863e7a45",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/7",
                            "linkTarget": "Url",
                            "linkLabel": "Security Alerts",
                            "style": "link"
                          },
                          {
                            "id": "a04dc36a-ab28-4270-b0e9-fd3bcf96f96f",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/26",
                            "linkTarget": "Url",
                            "linkLabel": "Workload Protection",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 1"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "  securityresources\r\n  | where type =~ 'microsoft.security/locations/alerts'\r\n  | where properties.Status in ('Active')\r\n  | where properties.Severity in ('Low', 'Medium', 'High')\r\n  | extend SeverityRank = case(\r\n    properties.Severity == 'High', 3,\r\n    properties.Severity == 'Medium', 2,\r\n    properties.Severity == 'Low', 1,\r\n    0\r\n   )\r\n  | project-away SeverityRank\r\n  | extend Severity = properties.Severity\r\n  | project Severity = tostring(Severity)\r\n  | summarize Count = count() by Severity",
                        "size": 2,
                        "title": "Alerts by Severity",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "piechart",
                        "chartSettings": {
                          "yAxis": [
                            "Count"
                          ],
                          "seriesLabelSettings": [
                            {
                              "seriesName": "Medium",
                              "color": "orange"
                            },
                            {
                              "seriesName": "Low",
                              "color": "yellow"
                            },
                            {
                              "seriesName": "High",
                              "color": "redBright"
                            }
                          ]
                        }
                      },
                      "customWidth": "33",
                      "name": "query - 2",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "securityresources\r\n  | where type =~ 'microsoft.security/locations/alerts'\r\n    | extend Prop = parse_json(properties)\r\n  | extend AlertDisplayName = Prop.[\"AlertDisplayName\"]\r\n  | project tostring(AlertDisplayName)\r\n  | summarize AlertCount = count() by AlertDisplayName\r\n  | sort by AlertCount",
                        "size": 2,
                        "title": "Alerts",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "table",
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "AlertCount",
                              "formatter": 4,
                              "formatOptions": {
                                "palette": "greenRed",
                                "customColumnWidthSetting": "15ch"
                              }
                            }
                          ]
                        }
                      },
                      "customWidth": "66",
                      "name": "query - 5",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| extend resourceId = properties.resourceDetails.Id\r\n| extend resourceName = tostring(split(resourceId, \"/\")[8])\r\n| extend resourceGroup = (split(resourceId, \"/\")[4])\r\n| extend status = properties.status.code\r\n| extend recommendatioName = properties.displayName \r\n| project subscriptionId,\r\n\t\t  status,\r\n          resourceId,\r\n\t\t  recommendatioName,\r\n\t\t  resourceName",
                        "size": 3,
                        "title": "Recommendations by State",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 15,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true,
                                "customColumnWidthSetting": "50ch"
                              }
                            },
                            {
                              "columnMatch": "subscriptionId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Healthy",
                                    "representation": "success",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Unhealthy",
                                    "representation": "3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "resourceId",
                              "formatter": 13,
                              "formatOptions": {
                                "linkTarget": "Resource",
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "recommendatioName",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "resourceName",
                              "formatter": 5,
                              "formatOptions": {
                                "linkTarget": "Resource"
                              }
                            },
                            {
                              "columnMatch": "resourceGroup",
                              "formatter": 14,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            }
                          ],
                          "rowLimit": 500,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "subscriptionId",
                              "status"
                            ],
                            "expandTopLevel": false,
                            "finalBy": "recommendatioName"
                          },
                          "labelSettings": [
                            {
                              "columnId": "subscriptionId",
                              "label": "Subscription"
                            },
                            {
                              "columnId": "status",
                              "label": "Status"
                            },
                            {
                              "columnId": "resourceId",
                              "label": "Resource"
                            },
                            {
                              "columnId": "recommendatioName",
                              "label": "Recommendation Name"
                            }
                          ]
                        }
                      },
                      "customWidth": "50",
                      "name": "query - 6",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "SecurityResources\r\n| where type == 'microsoft.security/securescores'\r\n| project subscriptionId,\r\n\tsubscriptionTotal = iff(properties.score.max == 0, 0.00, round(tolong(properties.weight) * todouble(properties.score.current)/tolong(properties.score.max),2)),\r\n\tweight = tolong(iff(properties.weight == 0, 1, properties.weight))\r\n| join kind=leftouter (\r\n\tResourceContainers\r\n\t| where type == 'microsoft.resources/subscriptions' and properties.state == 'Enabled'\r\n\t| project subscriptionId, mgChain=properties.managementGroupAncestorsChain )\r\n\ton subscriptionId\r\n| mv-expand mg=mgChain\r\n| summarize sumSubs = sum(subscriptionTotal), sumWeight = sum(weight), resultsNum = count() by tostring(mg.displayName), mgId = tostring(mg.name)\r\n| extend secureScore = iff(tolong(resultsNum) == 0, 404.00, round(sumSubs/sumWeight*100,2))\r\n| project toint(secureScore), mgName=mg_displayName\r\n| sort by secureScore asc",
                        "size": 3,
                        "title": "Secure Score by Management Group",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "secureScore",
                              "formatter": 4,
                              "formatOptions": {
                                "min": 0,
                                "max": 100,
                                "palette": "hotCold",
                                "customColumnWidthSetting": "30ch"
                              },
                              "numberFormat": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ],
                          "labelSettings": [
                            {
                              "columnId": "secureScore",
                              "label": "Secure Score"
                            },
                            {
                              "columnId": "mgName",
                              "label": "Management Group"
                            }
                          ]
                        }
                      },
                      "customWidth": "50",
                      "name": "query - 6",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Defender for Cloud"
                },
                "name": "dfc"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "5ac541ef-0206-47fd-84be-6134b685bdf3",
                            "cellValue": "https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.RecoveryServices%2Fvaults",
                            "linkTarget": "Url",
                            "linkLabel": "Recovery Services Vaults",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 1"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources\r\n| where type in ('microsoft.recoveryservices/vaults')\r\n| summarize count() by type",
                        "size": 4,
                        "title": "Azure Site Recovery Resources",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "tiles",
                        "tileSettings": {
                          "titleContent": {
                            "columnMatch": "type",
                            "formatter": 16,
                            "formatOptions": {
                              "showIcon": true
                            }
                          },
                          "leftContent": {
                            "columnMatch": "count_",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "style": "decimal",
                                "maximumFractionDigits": 2,
                                "maximumSignificantDigits": 3
                              }
                            }
                          },
                          "showBorder": true,
                          "size": "auto"
                        }
                      },
                      "name": "query - 0"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Azure Site Recovery"
                },
                "name": "asr"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "5ac541ef-0206-47fd-84be-6134b685bdf3",
                            "cellValue": "https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel",
                            "linkTarget": "Url",
                            "linkLabel": "Microsoft Sentinel",
                            "style": "link"
                          },
                          {
                            "id": "b4cfce6b-a1c4-4ce6-b2c3-7173074583e9",
                            "cellValue": "https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.OperationalInsights%2Fworkspaces",
                            "linkTarget": "Url",
                            "linkLabel": "Log Analytics Workspace",
                            "style": "link"
                          },
                          {
                            "id": "b1e5c3b1-f569-40d5-afa8-fbcefc26815f",
                            "cellValue": "https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.Logic%2Fworkflows",
                            "linkTarget": "Url",
                            "linkLabel": "Logic Apps",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 1"
                    },
                    {
                      "type": 9,
                      "content": {
                        "version": "KqlParameterItem/1.0",
                        "parameters": [
                          {
                            "id": "541627ee-8d8e-48b5-bf16-72dbc4007f96",
                            "version": "KqlParameterItem/1.0",
                            "name": "mssubscription",
                            "label": "Microsoft Sentinel Subscription",
                            "type": 6,
                            "isRequired": true,
                            "value": "",
                            "typeSettings": {
                              "additionalResourceOptions": [],
                              "includeAll": false
                            },
                            "timeContext": {
                              "durationMs": 86400000
                            }
                          },
                          {
                            "id": "25f11fa4-e560-4116-95e1-dd401234d745",
                            "version": "KqlParameterItem/1.0",
                            "name": "msworkspace",
                            "label": "Microsoft Sentinel Workspace",
                            "type": 5,
                            "isRequired": true,
                            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| project id",
                            "crossComponentResources": [
                              "{mssubscription}"
                            ],
                            "value": "",
                            "typeSettings": {
                              "additionalResourceOptions": [],
                              "showDefault": false
                            },
                            "timeContext": {
                              "durationMs": 86400000
                            },
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources"
                          },
                          {
                            "id": "abd55f41-8088-4d1b-8b47-17a79a7b15e3",
                            "version": "KqlParameterItem/1.0",
                            "name": "timerange",
                            "label": "Time Range",
                            "type": 4,
                            "value": {
                              "durationMs": 7776000000
                            },
                            "typeSettings": {
                              "selectableValues": [
                                {
                                  "durationMs": 86400000
                                },
                                {
                                  "durationMs": 604800000
                                },
                                {
                                  "durationMs": 1209600000
                                },
                                {
                                  "durationMs": 2592000000
                                },
                                {
                                  "durationMs": 7776000000
                                }
                              ]
                            },
                            "timeContext": {
                              "durationMs": 86400000
                            }
                          }
                        ],
                        "style": "pills",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      "name": "parameters - 3"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "SecurityIncident\r\n| where CreatedTime {timerange:value}\r\n| summarize \r\n    Count=count(), \r\n    New=countif(Status==\"New\"), \r\n    Active=countif(Status==\"Active\"), \r\n    Closed=countif(Status==\"Closed\")\r\nby Severity\r\n| order by New desc\r\n| project Severity, New, Active, Closed",
                        "size": 4,
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{msworkspace}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Severity",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Informational",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "New",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "redBright"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Active",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "yellow"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Closed",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "green"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ]
                        }
                      },
                      "name": "query - 4",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "SecurityIncident\r\n| where CreatedTime {timerange:value}\r\n| extend Owner = Owner.assignedTo\r\n| sort by TimeGenerated\r\n| project CreatedTime, ClosedTime, IncidentNumber, Title, Status, Severity, Owner, IncidentUrl, ProviderName",
                        "size": 0,
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "crossComponentResources": [
                          "{msworkspace}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "ClosedTime",
                              "formatter": 6
                            },
                            {
                              "columnMatch": "Status",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "New",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Active",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Closed",
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "Severity",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "High",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Medium",
                                    "representation": "Sev1",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Low",
                                    "representation": "Sev2",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "contains",
                                    "thresholdValue": "Informational",
                                    "representation": "Sev3",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "more",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "IncidentUrl",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url"
                              }
                            },
                            {
                              "columnMatch": "Closed",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "green"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "New",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "redBright"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            },
                            {
                              "columnMatch": "Active",
                              "formatter": 8,
                              "formatOptions": {
                                "palette": "yellow"
                              },
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ],
                          "rowLimit": 500,
                          "labelSettings": [
                            {
                              "columnId": "CreatedTime",
                              "label": "Date Created"
                            },
                            {
                              "columnId": "ClosedTime",
                              "label": "Date Closed"
                            },
                            {
                              "columnId": "IncidentNumber",
                              "label": "Incident"
                            },
                            {
                              "columnId": "ProviderName",
                              "label": "Provider"
                            }
                          ]
                        }
                      },
                      "name": "inc",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Microsoft Sentinel"
                },
                "name": "ms"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "nav",
                        "links": [
                          {
                            "id": "5ac541ef-0206-47fd-84be-6134b685bdf3",
                            "cellValue": "https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/28",
                            "linkTarget": "Url",
                            "linkLabel": "System Updates Workbook",
                            "preText": "Defender for Cloud",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 1"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "The update management information on this page is based on the [**Defender for Cloud**](https://portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/0) recommendation [**System updates should be installed on your machines**](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/4ab6e3c5-74dd-8b35-9ab9-f61b30875b27).",
                        "style": "info"
                      },
                      "conditionalVisibility": {
                        "parameterName": "ShowHelp",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "text - 7"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\"\r\n| project state = tostring(properties.status.code)\r\n| summarize ResourcesCount = count() by tostring(state)",
                        "size": 1,
                        "title": "Resources by Health",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "piechart",
                        "chartSettings": {
                          "seriesLabelSettings": [
                            {
                              "seriesName": "NotApplicable",
                              "color": "gray"
                            },
                            {
                              "seriesName": "Healthy",
                              "color": "green"
                            },
                            {
                              "seriesName": "Unhealthy",
                              "color": "redBright"
                            }
                          ]
                        }
                      },
                      "customWidth": "25",
                      "name": "byhlth",
                      "styleSettings": {
                        "showBorder": true
                      }
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n// Comment to identify the guid\r\n| where assessmentKey == \"4ab6e3c5-74dd-8b35-9ab9-f61b30875b27\" \r\n| where properties.status.code =~ 'Unhealthy'\r\n|Â project ResourceId = substring(id,Â 0,Â indexof(id,Â '/providers/Microsoft.Security')), subscriptionId, ResourceGroup = substring(id,Â 0,Â indexof(id,Â '/providers'))\r\n| summarize VMcount = dcount(ResourceId) by ResourceGroup, subscriptionId\r\n| order by VMcount desc",
                        "size": 3,
                        "title": "Resources with Missing Updates by Resource Group",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "$gen_group",
                              "formatter": 15,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            },
                            {
                              "columnMatch": "ResourceGroup",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "subscriptionId",
                              "formatter": 5
                            },
                            {
                              "columnMatch": "VMcount",
                              "formatter": 4,
                              "formatOptions": {
                                "palette": "blue",
                                "customColumnWidthSetting": "30ch"
                              }
                            }
                          ],
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "subscriptionId"
                            ],
                            "expandTopLevel": true,
                            "finalBy": "ResourceGroup"
                          },
                          "labelSettings": [
                            {
                              "columnId": "ResourceGroup",
                              "label": "Resource Group"
                            },
                            {
                              "columnId": "subscriptionId",
                              "label": "Subscription"
                            },
                            {
                              "columnId": "VMcount",
                              "label": "Resources Missing Updates"
                            }
                          ]
                        }
                      },
                      "customWidth": "75",
                      "name": "rscmiss",
                      "styleSettings": {
                        "showBorder": true
                      }
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "Azure Update Management"
                },
                "name": "aum"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "selectedTab",
            "comparison": "isEqualTo",
            "value": "Environment"
          },
          "name": "envgrp"
        }
      ],
      "isLocked": false,
      "fallbackResourceIds": [
        "azure monitor"
      ]
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "Microsoft.Insights/workbooks",
      "location": "[resourceGroup().location]",
      "kind": "shared",
      "apiVersion": "2021-03-08",
      "dependsOn": [],
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "[string(variables('workbookContent'))]",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  }
}